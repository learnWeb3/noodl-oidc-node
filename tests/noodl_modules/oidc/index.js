!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t){e.exports=React},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n={purple:"component",green:"data",default:"default",grey:"default"};Noodl.defineNode=function(e){var t={};for(var i in t.name=e.name,t.displayNodeName=e.displayName,t.usePortAsLabel=e.useInputAsLabel,t.color=n[e.color||"default"],t.category=e.category||"Modules",t.getInspectInfo=e.getInspectInfo,t.docs=e.docs,t.initialize=function(){this.inputs={};var t=this.outputs={},r=this;this.setOutputs=function(e){for(var n in e)t[n]=e[n],r.flagOutputDirty(n)},this.clearWarnings=function(){this.context.editorConnection&&this.nodeScope&&this.nodeScope.componentOwner&&this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id)}.bind(this),this.sendWarning=function(e,t){this.context.editorConnection&&this.nodeScope&&this.nodeScope.componentOwner&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,e,{message:t})}.bind(this),"function"==typeof e.initialize&&e.initialize.apply(this)},t.inputs={},t.outputs={},e.inputs)t.inputs[i]={type:"object"===r(e.inputs[i])?e.inputs[i].type:e.inputs[i],displayName:"object"===r(e.inputs[i])?e.inputs[i].displayName:void 0,group:"object"===r(e.inputs[i])?e.inputs[i].group:void 0,default:"object"===r(e.inputs[i])?e.inputs[i].default:void 0,set:function(){var t=i;return function(r){this.inputs[t]=r,e.changed&&"function"==typeof e.changed[t]&&e.changed[t].apply(this,[r])}}()};for(var i in e.signals)t.inputs[i]={type:"signal",displayName:"object"===r(e.signals[i])?e.signals[i].displayName:void 0,group:"object"===r(e.signals[i])?e.signals[i].group:void 0,valueChangedToTrue:function(){var t=i;return function(){var n=this,i="object"===r(e.signals[t])?e.signals[t].signal:e.signals[t];"function"==typeof i&&this.scheduleAfterInputsHaveUpdated((function(){i.apply(n)}))}}()};for(var i in e.outputs)"signal"===e.outputs[i]?t.outputs[i]={type:"signal"}:t.outputs[i]={type:"object"===r(e.outputs[i])?e.outputs[i].type:e.outputs[i],displayName:"object"===r(e.outputs[i])?e.outputs[i].displayName:void 0,group:"object"===r(e.outputs[i])?e.outputs[i].group:void 0,getter:function(){var e=i;return function(){return this.outputs[e]}}()};for(var i in t.methods=t.prototypeExtensions={},e.methods)t.prototypeExtensions[i]=e.methods[i];return t.methods.onNodeDeleted&&(t.methods._onNodeDeleted=function(){this.__proto__.__proto__._onNodeDeleted.call(this),t.methods.onNodeDeleted.value.call(this)}),{node:t,setup:e.setup}},Noodl.defineCollectionNode=function(e){var t={name:e.name,category:e.category,color:"data",inputs:e.inputs,outputs:Object.assign({Items:"array","Fetch Started":"signal","Fetch Completed":"signal"},e.outputs||{}),signals:Object.assign({Fetch:function(){var t=this;this.sendSignalOnOutput("Fetch Started");var r=e.fetch.call(this,(function(){t.sendSignalOnOutput("Fetch Completed")}));this.setOutputs({Items:r})}},e.signals||{})};return Noodl.defineNode(t)},Noodl.defineModelNode=function(e){var t={name:e.name,category:e.category,color:"data",inputs:{Id:"string"},outputs:{Fetched:"signal"},changed:{Id:function(e){var t=this;this._object&&this._changeListener&&this._object.off("change",this._changeListener),this._object=Noodl.Object.get(e),this._changeListener=function(e,r){var n={};n[e]=r,t.setOutputs(n)},this._object.on("change",this._changeListener),this.setOutputs(this._object.data),this.sendSignalOnOutput("Fetched")}},initialize:function(){}};for(var r in e.properties)t.inputs[r]=e.properties[r],t.outputs[r]=e.properties[r],t.changed[r]=function(){var e=r;return function(t){this._object&&this._object.set(e,t)}}();return Noodl.defineNode(t)},Noodl.defineReactNode=function(e){var t=Noodl.defineNode(e);return t.node.getReactComponent=e.getReactComponent,t.node.inputProps=e.inputProps,t.node.inputCss=e.inputCss,t.node.outputProps=e.outputProps,t.node.setup=e.setup,t.node.frame=e.frame,t.node},e.exports=Noodl},function(e,t,r){"use strict";var n=["children","onSigninCallback","skipSigninCallback","matchSignoutCallback","onSignoutCallback","onRemoveUser","userManager"];function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,s=Object.create(i.prototype),a=new P(n||[]);return o(s,"_invoke",{value:O(e,r,a)}),s}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",g="executing",y="completed",v={};function m(){}function _(){}function b(){}var w={};l(w,a,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(N([])));S&&S!==r&&n.call(S,a)&&(w=S);var x=b.prototype=m.prototype=Object.create(w);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function r(i,o,s,a){var u=f(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==h(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,a)}))}a(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}})}function O(t,r,n){var i=d;return function(o,s){if(i===g)throw Error("Generator is already running");if(i===y){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=T(a,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=g;var c=f(t,r,n);if("normal"===c.type){if(i=n.done?y:"suspendedYield",c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=y,n.method="throw",n.arg=c.arg)}}}function T(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=f(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(h(t)+" is not iterable")}return _.prototype=b,o(x,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=l(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},E(I.prototype),l(I.prototype,u,(function(){return this})),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new I(p(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function o(e,t,r,n,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function a(e){o(s,n,i,a,u,"next",e)}function u(e){o(s,n,i,a,u,"throw",e)}a(void 0)}))}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d,g=Object.create,y=Object.defineProperty,v=Object.getOwnPropertyDescriptor,m=Object.getOwnPropertyNames,_=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,w=function(e,t,r,n){if(t&&"object"===h(t)||"function"==typeof t){var i,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}(m(t));try{var s=function(){var o=i.value;b.call(e,o)||o===r||y(e,o,{get:function(){return t[o]},enumerable:!(n=v(t,o))||n.enumerable})};for(o.s();!(i=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}}return e},k=function(e,t,r){return r=null!=e?g(_(e)):{},w(!t&&e&&e.__esModule?r:y(r,"default",{value:e,enumerable:!0}),e)},S={};!function(e,t){for(var r in t)y(e,r,{get:t[r],enumerable:!0})}(S,{AuthContext:function(){return x},AuthProvider:function(){return M},hasAuthParams:function(){return C},useAuth:function(){return q},withAuth:function(){return $},withAuthenticationRequired:function(){return H}}),e.exports=(d=S,w(y({},"__esModule",{value:!0}),d));var x=k(r(0)).default.createContext(void 0);x.displayName="AuthContext";var E=k(r(0)),I=r(7),O={isLoading:!0,isAuthenticated:!1},T=function(e,t){switch(t.type){case"INITIALISED":case"USER_LOADED":return c(c({},e),{},{user:t.user,isLoading:!1,isAuthenticated:!!t.user&&!t.user.expired,error:void 0});case"USER_SIGNED_OUT":case"USER_UNLOADED":return c(c({},e),{},{user:void 0,isAuthenticated:!1});case"NAVIGATOR_INIT":return c(c({},e),{},{isLoading:!0,activeNavigator:t.method});case"NAVIGATOR_CLOSE":return c(c({},e),{},{isLoading:!1,activeNavigator:void 0});case"ERROR":return c(c({},e),{},{isLoading:!1,error:t.error});default:return c(c({},e),{},{isLoading:!1,error:new Error("unknown type ".concat(t.type))})}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,t=new URLSearchParams(e.search);return!(!t.get("code")&&!t.get("error")||!t.get("state"))||!(!(t=new URLSearchParams(e.hash.replace("#","?"))).get("code")&&!t.get("error")||!t.get("state"))},R=function(e){return function(t){return t instanceof Error?t:new Error(e)}},P=R("Sign-in failed"),N=R("Sign-out failed"),A=["clearStaleState","querySessionStatus","revokeTokens","startSilentRenew","stopSilentRenew"],j=["signinPopup","signinSilent","signinRedirect","signinResourceOwnerCredentials","signoutPopup","signoutRedirect","signoutSilent"],L=function(e){return function(){throw new Error("UserManager#".concat(e," was called from an unsupported context. If this is a server-rendered page, defer this call with useEffect() or pass a custom UserManager implementation."))}},U="undefined"==typeof window?null:I.UserManager,M=function(e){var t=e.children,r=e.onSigninCallback,o=e.skipSigninCallback,u=e.matchSignoutCallback,l=e.onSignoutCallback,p=e.onRemoveUser,f=e.userManager,h=void 0===f?null:f,d=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,n),g=a((0,E.useState)((function(){return null!=h?h:U?new U(d):{settings:d}})),1)[0],y=a((0,E.useReducer)(T,O),2),v=y[0],m=y[1],_=(0,E.useMemo)((function(){return Object.assign({settings:g.settings,events:g.events},Object.fromEntries(A.map((function(e){var t,r;return[e,null!=(r=null==(t=g[e])?void 0:t.bind(g))?r:L(e)]}))),Object.fromEntries(j.map((function(e){return[e,g[e]?function(){var t=s(i().mark((function t(r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m({type:"NAVIGATOR_INIT",method:e}),t.prev=1,t.next=4,g[e](r);case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),m({type:"ERROR",error:t.t0}),t.abrupt("return",null);case 11:return t.prev=11,m({type:"NAVIGATOR_CLOSE"}),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,7,11,14]])})));return function(e){return t.apply(this,arguments)}}():L(e)]}))))}),[g]),b=(0,E.useRef)(!1);(0,E.useEffect)((function(){g&&!b.current&&(b.current=!0,s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,e.prev=1,!C()||o){e.next=10;break}return e.next=5,g.signinCallback();case 5:if(t=e.sent,e.t0=r,!e.t0){e.next=10;break}return e.next=10,r(t);case 10:if(t){e.next=16;break}return e.next=13,g.getUser();case 13:e.t1=e.sent,e.next=17;break;case 16:e.t1=t;case 17:t=e.t1,m({type:"INITIALISED",user:t}),e.next=24;break;case 21:e.prev=21,e.t2=e.catch(1),m({type:"ERROR",error:P(e.t2)});case 24:if(e.prev=24,!u||!u(g.settings)){e.next=32;break}return e.next=28,g.signoutCallback();case 28:if(e.t3=l,!e.t3){e.next=32;break}return e.next=32,l();case 32:e.next=37;break;case 34:e.prev=34,e.t4=e.catch(24),m({type:"ERROR",error:N(e.t4)});case 37:case"end":return e.stop()}}),e,null,[[1,21],[24,34]])})))())}),[g,o,r,l,u]),(0,E.useEffect)((function(){if(g){var e=function(e){m({type:"USER_LOADED",user:e})};g.events.addUserLoaded(e);var t=function(){m({type:"USER_UNLOADED"})};g.events.addUserUnloaded(t);var r=function(){m({type:"USER_SIGNED_OUT"})};g.events.addUserSignedOut(r);var n=function(e){m({type:"ERROR",error:e})};return g.events.addSilentRenewError(n),function(){g.events.removeUserLoaded(e),g.events.removeUserUnloaded(t),g.events.removeUserSignedOut(r),g.events.removeSilentRenewError(n)}}}),[g]);var w=(0,E.useCallback)(g?function(){return g.removeUser().then(p)}:L("removeUser"),[g,p]);return E.default.createElement(x.Provider,{value:c(c(c({},v),_),{},{removeUser:w})},t)},D=k(r(0)),q=function(){var e=D.default.useContext(x);return e||console.warn("AuthProvider context is undefined, please verify you are calling useAuth() as child of a <AuthProvider> component."),e},F=k(r(0));function $(e){var t="withAuth(".concat(e.displayName||e.name,")"),r=function(t){var r=q();return F.default.createElement(e,c(c({},t),{},{auth:r}))};return r.displayName=t,r}var B=k(r(0)),H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.OnRedirecting,n=void 0===r?function(){return B.default.createElement(B.default.Fragment,null)}:r,o=t.onBeforeSignin,a=t.signinRedirectArgs,u="withAuthenticationRequired(".concat(e.displayName||e.name,")"),l=function(t){var r=q();return B.default.useEffect((function(){C()||r.isLoading||r.activeNavigator||r.isAuthenticated||s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=o,!e.t0){e.next=4;break}return e.next=4,o();case 4:return e.next=6,r.signinRedirect(a);case 6:case"end":return e.stop()}}),e)})))()}),[r.isLoading,r.isAuthenticated,o,a]),r.isAuthenticated?B.default.createElement(e,c({},t)):n()};return l.displayName=u,l}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,r){return t=f(t),function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,r||[],f(e).constructor):t.apply(e,r))}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)})(e)}function c(e,t,r){if(l())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&p(i,r.prototype),i}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.r(t),r.d(t,"InvalidTokenError",(function(){return h})),r.d(t,"jwtDecode",(function(){return g}));var h=function(e){function t(){return s(this,t),a(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),r=t,n&&i(r.prototype,n),o&&i(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(u(Error));function d(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return atob(t)}}function g(e,t){if("string"!=typeof e)throw new h("Invalid token specified: must be a string");t||(t={});var r,n=!0===t.header?0:1,i=e.split(".")[n];if("string"!=typeof i)throw new h("Invalid token specified: missing part #".concat(n+1));try{r=d(i)}catch(e){throw new h("Invalid token specified: invalid base64 for part #".concat(n+1," (").concat(e.message,")"))}try{return JSON.parse(r)}catch(e){throw new h("Invalid token specified: invalid json for part #".concat(n+1," (").concat(e.message,")"))}}h.prototype.name="InvalidTokenError"},function(e,t,r){(function(r){var n,i,o,s;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! jsonpath 1.1.1 */s=function(){return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[s]={exports:{}};t[s][0].call(c.exports,(function(e){var r=t[s][1][e];return i(r||e)}),c,c.exports,e,t,r,n)}return r[s].exports}for(var o=!1,s=0;s<n.length;s++)i(n[s]);return i}({"./aesprim":[function(e,t,r){!function(e,t){"use strict";t(void 0!==r?r:e.esprima={})}(this,(function(e){"use strict";var t,r,n,i,o,s,a,u,c,l,p,f,h,d,g,y,v,m;function _(e,t){if(!e)throw new Error("ASSERT: "+t)}function b(e){return e>=48&&e<=57}function w(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function k(e){return"01234567".indexOf(e)>=0}function S(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function x(e){return 10===e||13===e||8232===e||8233===e}function E(e){return 64==e||36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&a.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function I(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&a.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function O(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function T(e){return"eval"===e||"arguments"===e}function C(e,t,r,n,i){var o;_("number"==typeof r,"Comment must have valid position"),v.lastCommentStart>=r||(v.lastCommentStart=r,o={type:e,value:t},m.range&&(o.range=[r,n]),m.loc&&(o.loc=i),m.comments.push(o),m.attachComment&&(m.leadingComments.push(o),m.trailingComments.push(o)))}function R(e){var t,r,n,i;for(t=p-e,r={start:{line:f,column:p-h-e}};p<d;)if(n=c.charCodeAt(p),++p,x(n))return m.comments&&(i=c.slice(t+e,p-1),r.end={line:f,column:p-h-1},C("Line",i,t,p-1,r)),13===n&&10===c.charCodeAt(p)&&++p,++f,void(h=p);m.comments&&(i=c.slice(t+e,p),r.end={line:f,column:p-h},C("Line",i,t,p,r))}function P(){var e,t,r,n;for(m.comments&&(e=p-2,t={start:{line:f,column:p-h-2}});p<d;)if(x(r=c.charCodeAt(p)))13===r&&10===c.charCodeAt(p+1)&&++p,++f,++p,h=p,p>=d&&K({},s.UnexpectedToken,"ILLEGAL");else if(42===r){if(47===c.charCodeAt(p+1))return++p,++p,void(m.comments&&(n=c.slice(e+2,p-2),t.end={line:f,column:p-h},C("Block",n,e,p,t)));++p}else++p;K({},s.UnexpectedToken,"ILLEGAL")}function N(){var e,t;for(t=0===p;p<d;)if(S(e=c.charCodeAt(p)))++p;else if(x(e))++p,13===e&&10===c.charCodeAt(p)&&++p,++f,h=p,t=!0;else if(47===e)if(47===(e=c.charCodeAt(p+1)))++p,++p,R(2),t=!0;else{if(42!==e)break;++p,++p,P()}else if(t&&45===e){if(45!==c.charCodeAt(p+1)||62!==c.charCodeAt(p+2))break;p+=3,R(3)}else{if(60!==e)break;if("!--"!==c.slice(p+1,p+4))break;++p,++p,++p,++p,R(4)}}function A(e){var t,r,n,i=0;for(r="u"===e?4:2,t=0;t<r;++t){if(!(p<d&&w(c[p])))return"";n=c[p++],i=16*i+"0123456789abcdef".indexOf(n.toLowerCase())}return String.fromCharCode(i)}function j(){var e,t;for(e=c.charCodeAt(p++),t=String.fromCharCode(e),92===e&&(117!==c.charCodeAt(p)&&K({},s.UnexpectedToken,"ILLEGAL"),++p,(e=A("u"))&&"\\"!==e&&E(e.charCodeAt(0))||K({},s.UnexpectedToken,"ILLEGAL"),t=e);p<d&&I(e=c.charCodeAt(p));)++p,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==c.charCodeAt(p)&&K({},s.UnexpectedToken,"ILLEGAL"),++p,(e=A("u"))&&"\\"!==e&&I(e.charCodeAt(0))||K({},s.UnexpectedToken,"ILLEGAL"),t+=e);return t}function L(){var e,r;return e=p,{type:1===(r=92===c.charCodeAt(p)?j():function(){var e,t;for(e=p++;p<d;){if(92===(t=c.charCodeAt(p)))return p=e,j();if(!I(t))break;++p}return c.slice(e,p)}()).length?t.Identifier:function(e){if(l&&O(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}(r)?t.Keyword:"null"===r?t.NullLiteral:"true"===r||"false"===r?t.BooleanLiteral:t.Identifier,value:r,lineNumber:f,lineStart:h,start:e,end:p}}function U(){var e,r,n,i,o=p,a=c.charCodeAt(p),u=c[p];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++p,m.tokenize&&(40===a?m.openParenToken=m.tokens.length:123===a&&(m.openCurlyToken=m.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(a),lineNumber:f,lineStart:h,start:o,end:p};default:if(61===(e=c.charCodeAt(p+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return p+=2,{type:t.Punctuator,value:String.fromCharCode(a)+String.fromCharCode(e),lineNumber:f,lineStart:h,start:o,end:p};case 33:case 61:return p+=2,61===c.charCodeAt(p)&&++p,{type:t.Punctuator,value:c.slice(o,p),lineNumber:f,lineStart:h,start:o,end:p}}}return">>>="===(i=c.substr(p,4))?{type:t.Punctuator,value:i,lineNumber:f,lineStart:h,start:o,end:p+=4}:">>>"===(n=i.substr(0,3))||"<<="===n||">>="===n?{type:t.Punctuator,value:n,lineNumber:f,lineStart:h,start:o,end:p+=3}:u===(r=n.substr(0,2))[1]&&"+-<>&|".indexOf(u)>=0||"=>"===r?{type:t.Punctuator,value:r,lineNumber:f,lineStart:h,start:o,end:p+=2}:"<>=!+-*%&|^/".indexOf(u)>=0?(++p,{type:t.Punctuator,value:u,lineNumber:f,lineStart:h,start:o,end:p}):void K({},s.UnexpectedToken,"ILLEGAL")}function M(){var e,r,n;if(_(b((n=c[p]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),r=p,e="","."!==n){if(e=c[p++],n=c[p],"0"===e){if("x"===n||"X"===n)return++p,function(e){for(var r="";p<d&&w(c[p]);)r+=c[p++];return 0===r.length&&K({},s.UnexpectedToken,"ILLEGAL"),E(c.charCodeAt(p))&&K({},s.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+r,16),lineNumber:f,lineStart:h,start:e,end:p}}(r);if(k(n))return function(e){for(var r="0"+c[p++];p<d&&k(c[p]);)r+=c[p++];return(E(c.charCodeAt(p))||b(c.charCodeAt(p)))&&K({},s.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(r,8),octal:!0,lineNumber:f,lineStart:h,start:e,end:p}}(r);n&&b(n.charCodeAt(0))&&K({},s.UnexpectedToken,"ILLEGAL")}for(;b(c.charCodeAt(p));)e+=c[p++];n=c[p]}if("."===n){for(e+=c[p++];b(c.charCodeAt(p));)e+=c[p++];n=c[p]}if("e"===n||"E"===n)if(e+=c[p++],"+"!==(n=c[p])&&"-"!==n||(e+=c[p++]),b(c.charCodeAt(p)))for(;b(c.charCodeAt(p));)e+=c[p++];else K({},s.UnexpectedToken,"ILLEGAL");return E(c.charCodeAt(p))&&K({},s.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:f,lineStart:h,start:r,end:p}}function D(){var e,r,n,i;return y=null,N(),e=p,r=function(){var e,t,r,n;for(_("/"===(e=c[p]),"Regular expression literal must start with a slash"),t=c[p++],r=!1,n=!1;p<d;)if(t+=e=c[p++],"\\"===e)x((e=c[p++]).charCodeAt(0))&&K({},s.UnterminatedRegExp),t+=e;else if(x(e.charCodeAt(0)))K({},s.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else{if("/"===e){n=!0;break}"["===e&&(r=!0)}return n||K({},s.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,r,n;for(t="",r="";p<d&&I((e=c[p]).charCodeAt(0));)if(++p,"\\"===e&&p<d)if("u"===(e=c[p])){if(n=++p,e=A("u"))for(r+=e,t+="\\u";n<p;++n)t+=c[n];else p=n,r+="u",t+="\\u";J({},s.UnexpectedToken,"ILLEGAL")}else t+="\\",J({},s.UnexpectedToken,"ILLEGAL");else r+=e,t+=e;return{value:r,literal:t}}(),i=function(e,t){var r;try{r=new RegExp(e,t)}catch(e){K({},s.InvalidRegExp)}return r}(r.value,n.value),m.tokenize?{type:t.RegularExpression,value:i,lineNumber:f,lineStart:h,start:e,end:p}:{literal:r.literal+n.literal,value:i,start:e,end:p}}function q(){var e,t,r,n;return N(),e=p,t={start:{line:f,column:p-h}},r=D(),t.end={line:f,column:p-h},m.tokenize||(m.tokens.length>0&&(n=m.tokens[m.tokens.length-1]).range[0]===e&&"Punctuator"===n.type&&("/"!==n.value&&"/="!==n.value||m.tokens.pop()),m.tokens.push({type:"RegularExpression",value:r.literal,range:[e,p],loc:t})),r}function F(){var e;return N(),p>=d?{type:t.EOF,lineNumber:f,lineStart:h,start:p,end:p}:E(e=c.charCodeAt(p))?L():40===e||41===e||59===e?U():39===e||34===e?function(){var e,r,n,i,o,a,u,l,g="",y=!1;for(u=f,l=h,_("'"===(e=c[p])||'"'===e,"String literal must starts with a quote"),r=p,++p;p<d;){if((n=c[p++])===e){e="";break}if("\\"===n)if((n=c[p++])&&x(n.charCodeAt(0)))++f,"\r"===n&&"\n"===c[p]&&++p,h=p;else switch(n){case"u":case"x":a=p,(o=A(n))?g+=o:(p=a,g+=n);break;case"n":g+="\n";break;case"r":g+="\r";break;case"t":g+="\t";break;case"b":g+="\b";break;case"f":g+="\f";break;case"v":g+="\v";break;default:k(n)?(0!==(i="01234567".indexOf(n))&&(y=!0),p<d&&k(c[p])&&(y=!0,i=8*i+"01234567".indexOf(c[p++]),"0123".indexOf(n)>=0&&p<d&&k(c[p])&&(i=8*i+"01234567".indexOf(c[p++]))),g+=String.fromCharCode(i)):g+=n}else{if(x(n.charCodeAt(0)))break;g+=n}}return""!==e&&K({},s.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:g,octal:y,startLineNumber:u,startLineStart:l,lineNumber:f,lineStart:h,start:r,end:p}}():46===e?b(c.charCodeAt(p+1))?M():U():b(e)?M():m.tokenize&&47===e?function(){var e,t;if(!(e=m.tokens[m.tokens.length-1]))return q();if("Punctuator"===e.type){if("]"===e.value)return U();if(")"===e.value)return!(t=m.tokens[m.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?U():q();if("}"===e.value){if(m.tokens[m.openCurlyToken-3]&&"Keyword"===m.tokens[m.openCurlyToken-3].type){if(!(t=m.tokens[m.openCurlyToken-4]))return U()}else{if(!m.tokens[m.openCurlyToken-4]||"Keyword"!==m.tokens[m.openCurlyToken-4].type)return U();if(!(t=m.tokens[m.openCurlyToken-5]))return q()}return n.indexOf(t.value)>=0?U():q()}return q()}return"Keyword"===e.type?q():U()}():U()}function $(){var e,n,i;return N(),e={start:{line:f,column:p-h}},n=F(),e.end={line:f,column:p-h},n.type!==t.EOF&&(i=c.slice(n.start,n.end),m.tokens.push({type:r[n.type],value:i,range:[n.start,n.end],loc:e})),n}function B(){var e;return p=(e=y).end,f=e.lineNumber,h=e.lineStart,y=void 0!==m.tokens?$():F(),p=e.end,f=e.lineNumber,h=e.lineStart,e}function H(){var e,t,r;e=p,t=f,r=h,y=void 0!==m.tokens?$():F(),p=e,f=t,h=r}function W(e,t){this.line=e,this.column=t}function z(e,t,r,n){this.start=new W(e,t),this.end=new W(r,n)}function G(){var e,t,r,n;return e=p,t=f,r=h,N(),n=f!==t,p=e,f=t,h=r,n}function K(e,t){var r,n=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){return _(t<n.length,"Message reference must be in range"),n[t]}));throw"number"==typeof e.lineNumber?((r=new Error("Line "+e.lineNumber+": "+i)).index=e.start,r.lineNumber=e.lineNumber,r.column=e.start-h+1):((r=new Error("Line "+f+": "+i)).index=p,r.lineNumber=f,r.column=p-h+1),r.description=i,r}function J(){try{K.apply(null,arguments)}catch(e){if(!m.errors)throw e;m.errors.push(e)}}function X(e){if(e.type===t.EOF&&K(e,s.UnexpectedEOS),e.type===t.NumericLiteral&&K(e,s.UnexpectedNumber),e.type===t.StringLiteral&&K(e,s.UnexpectedString),e.type===t.Identifier&&K(e,s.UnexpectedIdentifier),e.type===t.Keyword){if(function(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}(e.value))K(e,s.UnexpectedReserved);else if(l&&O(e.value))return void J(e,s.StrictReservedWord);K(e,s.UnexpectedToken,e.value)}K(e,s.UnexpectedToken,e.value)}function V(e){var r=B();r.type===t.Punctuator&&r.value===e||X(r)}function Q(e){var r=B();r.type===t.Keyword&&r.value===e||X(r)}function Y(e){return y.type===t.Punctuator&&y.value===e}function Z(e){return y.type===t.Keyword&&y.value===e}function ee(){var e;59===c.charCodeAt(p)||Y(";")?B():(e=f,N(),f===e&&(y.type===t.EOF||Y("}")||X(y)))}function te(e){return e.type===i.Identifier||e.type===i.MemberExpression}function re(e,t){var r,n,i;return r=l,i=y,n=Ee(),t&&l&&T(e[0].name)&&J(t,s.StrictParamName),l=r,g.markEnd(g.createFunctionExpression(null,e,[],n),i)}function ne(){var e,r;return r=y,(e=B()).type===t.StringLiteral||e.type===t.NumericLiteral?(l&&e.octal&&J(e,s.StrictOctalLiteral),g.markEnd(g.createLiteral(e),r)):g.markEnd(g.createIdentifier(e.value),r)}function ie(){var e,r,n,i,o,a;return a=y,(e=y).type===t.Identifier?(n=ne(),"get"!==e.value||Y(":")?"set"!==e.value||Y(":")?(V(":"),i=ge(),g.markEnd(g.createProperty("init",n,i),a)):(r=ne(),V("("),(e=y).type!==t.Identifier?(V(")"),J(e,s.UnexpectedToken,e.value),i=re([])):(o=[me()],V(")"),i=re(o,e)),g.markEnd(g.createProperty("set",r,i),a)):(r=ne(),V("("),V(")"),i=re([]),g.markEnd(g.createProperty("get",r,i),a))):e.type!==t.EOF&&e.type!==t.Punctuator?(r=ne(),V(":"),i=ge(),g.markEnd(g.createProperty("init",r,i),a)):void X(e)}function oe(){var e,r,n,a;if(Y("("))return function(){var e;return V("("),e=ye(),V(")"),e}();if(Y("["))return function(){var e,t=[];for(e=y,V("[");!Y("]");)Y(",")?(B(),t.push(null)):(t.push(ge()),Y("]")||V(","));return B(),g.markEnd(g.createArrayExpression(t),e)}();if(Y("{"))return function(){var e,t,r,n,a,u=[],c={},p=String;for(a=y,V("{");!Y("}");)t=(e=ie()).key.type===i.Identifier?e.key.name:p(e.key.value),n="init"===e.kind?o.Data:"get"===e.kind?o.Get:o.Set,r="$"+t,Object.prototype.hasOwnProperty.call(c,r)?(c[r]===o.Data?l&&n===o.Data?J({},s.StrictDuplicateProperty):n!==o.Data&&J({},s.AccessorDataProperty):n===o.Data?J({},s.AccessorDataProperty):c[r]&n&&J({},s.AccessorGetSet),c[r]|=n):c[r]=n,u.push(e),Y("}")||V(",");return V("}"),g.markEnd(g.createObjectExpression(u),a)}();if(e=y.type,a=y,e===t.Identifier)n=g.createIdentifier(B().value);else if(e===t.StringLiteral||e===t.NumericLiteral)l&&y.octal&&J(y,s.StrictOctalLiteral),n=g.createLiteral(B());else if(e===t.Keyword){if(Z("function"))return function(){var e,t,r,n,i,o,a,u,c,p=null;return c=y,Q("function"),Y("(")||(e=y,p=me(),l?T(e.value)&&J(e,s.StrictFunctionName):T(e.value)?(r=e,n=s.StrictFunctionName):O(e.value)&&(r=e,n=s.StrictReservedWord)),i=Ie(r),o=i.params,t=i.stricted,r=i.firstRestricted,i.message&&(n=i.message),u=l,a=Ee(),l&&r&&K(r,n),l&&t&&J(t,n),l=u,g.markEnd(g.createFunctionExpression(p,o,[],a),c)}();Z("this")?(B(),n=g.createThisExpression()):X(B())}else e===t.BooleanLiteral?((r=B()).value="true"===r.value,n=g.createLiteral(r)):e===t.NullLiteral?((r=B()).value=null,n=g.createLiteral(r)):Y("/")||Y("/=")?(n=void 0!==m.tokens?g.createLiteral(q()):g.createLiteral(D()),H()):X(B());return g.markEnd(n,a)}function se(){var e=[];if(V("("),!Y(")"))for(;p<d&&(e.push(ge()),!Y(")"));)V(",");return V(")"),e}function ae(){var e,r;return r=y,function(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}(e=B())||X(e),g.markEnd(g.createIdentifier(e.value),r)}function ue(){return V("."),ae()}function ce(){var e;return V("["),e=ye(),V("]"),e}function le(){var e,t,r;return r=y,Q("new"),e=function(){var e,t,r,n;for(n=y,e=v.allowIn,t=Z("new")?le():oe(),v.allowIn=e;Y(".")||Y("[");)Y("[")?(r=ce(),t=g.createMemberExpression("[",t,r)):(r=ue(),t=g.createMemberExpression(".",t,r)),g.markEnd(t,n);return t}(),t=Y("(")?se():[],g.markEnd(g.createNewExpression(e,t),r)}function pe(){var e,r,n=y;return e=function(){var e,t,r,n,i;for(i=y,e=v.allowIn,v.allowIn=!0,t=Z("new")?le():oe(),v.allowIn=e;;){if(Y("."))n=ue(),t=g.createMemberExpression(".",t,n);else if(Y("("))r=se(),t=g.createCallExpression(t,r);else{if(!Y("["))break;n=ce(),t=g.createMemberExpression("[",t,n)}g.markEnd(t,i)}return t}(),y.type===t.Punctuator&&(!Y("++")&&!Y("--")||G()||(l&&e.type===i.Identifier&&T(e.name)&&J({},s.StrictLHSPostfix),te(e)||J({},s.InvalidLHSInAssignment),r=B(),e=g.markEnd(g.createPostfixExpression(r.value,e),n))),e}function fe(){var e,r,n;return y.type!==t.Punctuator&&y.type!==t.Keyword?r=pe():Y("++")||Y("--")?(n=y,e=B(),r=fe(),l&&r.type===i.Identifier&&T(r.name)&&J({},s.StrictLHSPrefix),te(r)||J({},s.InvalidLHSInAssignment),r=g.createUnaryExpression(e.value,r),r=g.markEnd(r,n)):Y("+")||Y("-")||Y("~")||Y("!")?(n=y,e=B(),r=fe(),r=g.createUnaryExpression(e.value,r),r=g.markEnd(r,n)):Z("delete")||Z("void")||Z("typeof")?(n=y,e=B(),r=fe(),r=g.createUnaryExpression(e.value,r),r=g.markEnd(r,n),l&&"delete"===r.operator&&r.argument.type===i.Identifier&&J({},s.StrictDelete)):r=pe(),r}function he(e,r){var n=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":n=1;break;case"&&":n=2;break;case"|":n=3;break;case"^":n=4;break;case"&":n=5;break;case"==":case"!=":case"===":case"!==":n=6;break;case"<":case">":case"<=":case">=":case"instanceof":n=7;break;case"in":n=r?7:0;break;case"<<":case">>":case">>>":n=8;break;case"+":case"-":n=9;break;case"*":case"/":case"%":n=11}return n}function de(){var e,t,r,n,i;return i=y,e=function(){var e,t,r,n,i,o,s,a,u,c;if(e=y,u=fe(),0===(i=he(n=y,v.allowIn)))return u;for(n.prec=i,B(),t=[e,y],o=[u,n,s=fe()];(i=he(y,v.allowIn))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),r=g.createBinaryExpression(a,u,s),t.pop(),e=t[t.length-1],g.markEnd(r,e),o.push(r);(n=B()).prec=i,o.push(n),t.push(y),r=fe(),o.push(r)}for(r=o[c=o.length-1],t.pop();c>1;)r=g.createBinaryExpression(o[c-1].value,o[c-2],r),c-=2,e=t.pop(),g.markEnd(r,e);return r}(),Y("?")&&(B(),t=v.allowIn,v.allowIn=!0,r=ge(),v.allowIn=t,V(":"),n=ge(),e=g.createConditionalExpression(e,r,n),g.markEnd(e,i)),e}function ge(){var e,r,n,o,a,u;return e=y,a=y,o=r=de(),y.type!==t.Punctuator||"="!==(u=y.value)&&"*="!==u&&"/="!==u&&"%="!==u&&"+="!==u&&"-="!==u&&"<<="!==u&&">>="!==u&&">>>="!==u&&"&="!==u&&"^="!==u&&"|="!==u||(te(r)||J({},s.InvalidLHSInAssignment),l&&r.type===i.Identifier&&T(r.name)&&J(e,s.StrictLHSAssignment),e=B(),n=ge(),o=g.markEnd(g.createAssignmentExpression(e.value,r,n),a)),o}function ye(){var e,t=y;if(e=ge(),Y(",")){for(e=g.createSequenceExpression([e]);p<d&&Y(",");)B(),e.expressions.push(ge());g.markEnd(e,t)}return e}function ve(){var e,t;return t=y,V("{"),e=function(){for(var e,t=[];p<d&&!Y("}")&&void 0!==(e=Te());)t.push(e);return t}(),V("}"),g.markEnd(g.createBlockStatement(e),t)}function me(){var e,r;return r=y,(e=B()).type!==t.Identifier&&X(e),g.markEnd(g.createIdentifier(e.value),r)}function _e(e){var t,r,n=null;return r=y,t=me(),l&&T(t.name)&&J({},s.StrictVarName),"const"===e?(V("="),n=ge()):Y("=")&&(B(),n=ge()),g.markEnd(g.createVariableDeclarator(t,n),r)}function be(e){var t=[];do{if(t.push(_e(e)),!Y(","))break;B()}while(p<d);return t}function we(){var e,t,r,n,i,o,a,u,c,l;return e=t=r=null,Q("for"),V("("),Y(";")?B():(Z("var")||Z("let")?(v.allowIn=!1,l=y,u=B(),c=be(),e=g.markEnd(g.createVariableDeclaration(c,u.value),l),v.allowIn=!0,1===e.declarations.length&&Z("in")&&(B(),n=e,i=ye(),e=null)):(v.allowIn=!1,e=ye(),v.allowIn=!0,Z("in")&&(te(e)||J({},s.InvalidLHSInForIn),B(),n=e,i=ye(),e=null)),void 0===n&&V(";")),void 0===n&&(Y(";")||(t=ye()),V(";"),Y(")")||(r=ye())),V(")"),a=v.inIteration,v.inIteration=!0,o=xe(),v.inIteration=a,void 0===n?g.createForStatement(e,t,r,o):g.createForInStatement(n,i,o)}function ke(){var e,t,r,n=[];for(r=y,Z("default")?(B(),e=null):(Q("case"),e=ye()),V(":");p<d&&!(Y("}")||Z("default")||Z("case"));)t=xe(),n.push(t);return g.markEnd(g.createSwitchCase(e,n),r)}function Se(){var e,t,r,n,i=[],o=null;return Q("try"),e=ve(),Z("catch")&&i.push((n=y,Q("catch"),V("("),Y(")")&&X(y),t=me(),l&&T(t.name)&&J({},s.StrictCatchVariable),V(")"),r=ve(),g.markEnd(g.createCatchClause(t,r),n))),Z("finally")&&(B(),o=ve()),0!==i.length||o||K({},s.NoCatchOrFinally),g.createTryStatement(e,[],i,o)}function xe(){var e,r,n,o,a,u,f,h,m,_=y.type;if(_===t.EOF&&X(y),_===t.Punctuator&&"{"===y.value)return ve();if(o=y,_===t.Punctuator)switch(y.value){case";":return g.markEnd((V(";"),g.createEmptyStatement()),o);case"(":return g.markEnd(function(){var e=ye();return ee(),g.createExpressionStatement(e)}(),o)}if(_===t.Keyword)switch(y.value){case"break":return g.markEnd(function(){var e,r=null;return Q("break"),59===c.charCodeAt(p)?(B(),v.inIteration||v.inSwitch||K({},s.IllegalBreak),g.createBreakStatement(null)):G()?(v.inIteration||v.inSwitch||K({},s.IllegalBreak),g.createBreakStatement(null)):(y.type===t.Identifier&&(e="$"+(r=me()).name,Object.prototype.hasOwnProperty.call(v.labelSet,e)||K({},s.UnknownLabel,r.name)),ee(),null!==r||v.inIteration||v.inSwitch||K({},s.IllegalBreak),g.createBreakStatement(r))}(),o);case"continue":return g.markEnd(function(){var e,r=null;return Q("continue"),59===c.charCodeAt(p)?(B(),v.inIteration||K({},s.IllegalContinue),g.createContinueStatement(null)):G()?(v.inIteration||K({},s.IllegalContinue),g.createContinueStatement(null)):(y.type===t.Identifier&&(e="$"+(r=me()).name,Object.prototype.hasOwnProperty.call(v.labelSet,e)||K({},s.UnknownLabel,r.name)),ee(),null!==r||v.inIteration||K({},s.IllegalContinue),g.createContinueStatement(r))}(),o);case"debugger":return g.markEnd((Q("debugger"),ee(),g.createDebuggerStatement()),o);case"do":return g.markEnd((Q("do"),m=v.inIteration,v.inIteration=!0,f=xe(),v.inIteration=m,Q("while"),V("("),h=ye(),V(")"),Y(";")&&B(),g.createDoWhileStatement(f,h)),o);case"for":return g.markEnd(we(),o);case"function":return g.markEnd(Oe(),o);case"if":return g.markEnd(function(){var e,t,r;return Q("if"),V("("),e=ye(),V(")"),t=xe(),Z("else")?(B(),r=xe()):r=null,g.createIfStatement(e,t,r)}(),o);case"return":return g.markEnd((u=null,Q("return"),v.inFunctionBody||J({},s.IllegalReturn),32===c.charCodeAt(p)&&E(c.charCodeAt(p+1))?(u=ye(),ee(),g.createReturnStatement(u)):G()?g.createReturnStatement(null):(Y(";")||Y("}")||y.type===t.EOF||(u=ye()),ee(),g.createReturnStatement(u))),o);case"switch":return g.markEnd(function(){var e,t,r,n,i;if(Q("switch"),V("("),e=ye(),V(")"),V("{"),t=[],Y("}"))return B(),g.createSwitchStatement(e,t);for(n=v.inSwitch,v.inSwitch=!0,i=!1;p<d&&!Y("}");)null===(r=ke()).test&&(i&&K({},s.MultipleDefaultsInSwitch),i=!0),t.push(r);return v.inSwitch=n,V("}"),g.createSwitchStatement(e,t)}(),o);case"throw":return g.markEnd(function(){var e;return Q("throw"),G()&&K({},s.NewlineAfterThrow),e=ye(),ee(),g.createThrowStatement(e)}(),o);case"try":return g.markEnd(Se(),o);case"var":return g.markEnd((Q("var"),a=be(),ee(),g.createVariableDeclaration(a,"var")),o);case"while":return g.markEnd(function(){var e,t,r;return Q("while"),V("("),e=ye(),V(")"),r=v.inIteration,v.inIteration=!0,t=xe(),v.inIteration=r,g.createWhileStatement(e,t)}(),o);case"with":return g.markEnd(function(){var e,t;return l&&(N(),J({},s.StrictModeWith)),Q("with"),V("("),e=ye(),V(")"),t=xe(),g.createWithStatement(e,t)}(),o)}return(e=ye()).type===i.Identifier&&Y(":")?(B(),n="$"+e.name,Object.prototype.hasOwnProperty.call(v.labelSet,n)&&K({},s.Redeclaration,"Label",e.name),v.labelSet[n]=!0,r=xe(),delete v.labelSet[n],g.markEnd(g.createLabeledStatement(e,r),o)):(ee(),g.markEnd(g.createExpressionStatement(e),o))}function Ee(){var e,r,n,o,a,u,f,h,m=[];for(h=y,V("{");p<d&&y.type===t.StringLiteral&&(r=y,e=Te(),m.push(e),e.expression.type===i.Literal);)"use strict"===c.slice(r.start+1,r.end-1)?(l=!0,n&&J(n,s.StrictOctalLiteral)):!n&&r.octal&&(n=r);for(o=v.labelSet,a=v.inIteration,u=v.inSwitch,f=v.inFunctionBody,v.labelSet={},v.inIteration=!1,v.inSwitch=!1,v.inFunctionBody=!0;p<d&&!Y("}")&&void 0!==(e=Te());)m.push(e);return V("}"),v.labelSet=o,v.inIteration=a,v.inSwitch=u,v.inFunctionBody=f,g.markEnd(g.createBlockStatement(m),h)}function Ie(e){var t,r,n,i,o,a,u=[];if(V("("),!Y(")"))for(i={};p<d&&(r=y,t=me(),o="$"+r.value,l?(T(r.value)&&(n=r,a=s.StrictParamName),Object.prototype.hasOwnProperty.call(i,o)&&(n=r,a=s.StrictParamDupe)):e||(T(r.value)?(e=r,a=s.StrictParamName):O(r.value)?(e=r,a=s.StrictReservedWord):Object.prototype.hasOwnProperty.call(i,o)&&(e=r,a=s.StrictParamDupe)),u.push(t),i[o]=!0,!Y(")"));)V(",");return V(")"),{params:u,stricted:n,firstRestricted:e,message:a}}function Oe(){var e,t,r,n,i,o,a,u,c,p;return p=y,Q("function"),n=y,e=me(),l?T(n.value)&&J(n,s.StrictFunctionName):T(n.value)?(a=n,u=s.StrictFunctionName):O(n.value)&&(a=n,u=s.StrictReservedWord),t=(o=Ie(a)).params,i=o.stricted,a=o.firstRestricted,o.message&&(u=o.message),c=l,r=Ee(),l&&a&&K(a,u),l&&i&&J(i,u),l=c,g.markEnd(g.createFunctionDeclaration(e,t,[],r),p)}function Te(){if(y.type===t.Keyword)switch(y.value){case"const":case"let":return e=y.value,n=y,Q(e),r=be(e),ee(),g.markEnd(g.createVariableDeclaration(r,e),n);case"function":return Oe();default:return xe()}var e,r,n;if(y.type!==t.EOF)return xe()}function Ce(){var e,r;return N(),H(),r=y,l=!1,e=function(){for(var e,r,n,o=[];p<d&&(r=y).type===t.StringLiteral&&(e=Te(),o.push(e),e.expression.type===i.Literal);)"use strict"===c.slice(r.start+1,r.end-1)?(l=!0,n&&J(n,s.StrictOctalLiteral)):!n&&r.octal&&(n=r);for(;p<d&&void 0!==(e=Te());)o.push(e);return o}(),g.markEnd(g.createProgram(e),r)}function Re(){var e,t,r,n=[];for(e=0;e<m.tokens.length;++e)r={type:(t=m.tokens[e]).type,value:t.value},m.range&&(r.range=t.range),m.loc&&(r.loc=t.loc),n.push(r);m.tokens=n}(r={})[(t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",r[t.EOF]="<end>",r[t.Identifier]="Identifier",r[t.Keyword]="Keyword",r[t.NullLiteral]="Null",r[t.NumericLiteral]="Numeric",r[t.Punctuator]="Punctuator",r[t.StringLiteral]="String",r[t.RegularExpression]="RegularExpression",n=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],i={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},o={Data:1,Get:2,Set:4},s={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},a={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},u={name:"SyntaxTree",processComment:function(e){var t,r;if(!(e.type===i.Program&&e.body.length>0)){for(m.trailingComments.length>0?m.trailingComments[0].range[0]>=e.range[1]?(r=m.trailingComments,m.trailingComments=[]):m.trailingComments.length=0:m.bottomRightStack.length>0&&m.bottomRightStack[m.bottomRightStack.length-1].trailingComments&&m.bottomRightStack[m.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(r=m.bottomRightStack[m.bottomRightStack.length-1].trailingComments,delete m.bottomRightStack[m.bottomRightStack.length-1].trailingComments);m.bottomRightStack.length>0&&m.bottomRightStack[m.bottomRightStack.length-1].range[0]>=e.range[0];)t=m.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):m.leadingComments.length>0&&m.leadingComments[m.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=m.leadingComments,m.leadingComments=[]),r&&(e.trailingComments=r),m.bottomRightStack.push(e)}},markEnd:function(e,t){return m.range&&(e.range=[t.start,p]),m.loc&&(e.loc=new z(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),f,p-h),this.postProcess(e)),m.attachComment&&this.processComment(e),e},postProcess:function(e){return m.source&&(e.loc.source=m.source),e},createArrayExpression:function(e){return{type:i.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,r){return{type:i.AssignmentExpression,operator:e,left:t,right:r}},createBinaryExpression:function(e,t,r){return{type:"||"===e||"&&"===e?i.LogicalExpression:i.BinaryExpression,operator:e,left:t,right:r}},createBlockStatement:function(e){return{type:i.BlockStatement,body:e}},createBreakStatement:function(e){return{type:i.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:i.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:i.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,r){return{type:i.ConditionalExpression,test:e,consequent:t,alternate:r}},createContinueStatement:function(e){return{type:i.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:i.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:i.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:i.EmptyStatement}},createExpressionStatement:function(e){return{type:i.ExpressionStatement,expression:e}},createForStatement:function(e,t,r,n){return{type:i.ForStatement,init:e,test:t,update:r,body:n}},createForInStatement:function(e,t,r){return{type:i.ForInStatement,left:e,right:t,body:r,each:!1}},createFunctionDeclaration:function(e,t,r,n){return{type:i.FunctionDeclaration,id:e,params:t,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,r,n){return{type:i.FunctionExpression,id:e,params:t,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:i.Identifier,name:e}},createIfStatement:function(e,t,r){return{type:i.IfStatement,test:e,consequent:t,alternate:r}},createLabeledStatement:function(e,t){return{type:i.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:i.Literal,value:e.value,raw:c.slice(e.start,e.end)}},createMemberExpression:function(e,t,r){return{type:i.MemberExpression,computed:"["===e,object:t,property:r}},createNewExpression:function(e,t){return{type:i.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:i.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:i.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:i.Program,body:e}},createProperty:function(e,t,r){return{type:i.Property,key:t,value:r,kind:e}},createReturnStatement:function(e){return{type:i.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:i.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:i.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:i.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:i.ThisExpression}},createThrowStatement:function(e){return{type:i.ThrowStatement,argument:e}},createTryStatement:function(e,t,r,n){return{type:i.TryStatement,block:e,guardedHandlers:t,handlers:r,finalizer:n}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:i.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:i.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:i.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:i.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:i.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:i.WithStatement,object:e,body:t}}},e.version="1.2.2",e.tokenize=function(e,r){var n;"string"==typeof e||e instanceof String||(e=String(e)),g=u,p=0,f=(c=e).length>0?1:0,h=0,d=c.length,y=null,v={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},m={},(r=r||{}).tokens=!0,m.tokens=[],m.tokenize=!0,m.openParenToken=-1,m.openCurlyToken=-1,m.range="boolean"==typeof r.range&&r.range,m.loc="boolean"==typeof r.loc&&r.loc,"boolean"==typeof r.comment&&r.comment&&(m.comments=[]),"boolean"==typeof r.tolerant&&r.tolerant&&(m.errors=[]);try{if(H(),y.type===t.EOF)return m.tokens;for(B();y.type!==t.EOF;)try{B()}catch(e){if(m.errors){m.errors.push(e);break}throw e}Re(),n=m.tokens,void 0!==m.comments&&(n.comments=m.comments),void 0!==m.errors&&(n.errors=m.errors)}catch(e){throw e}finally{m={}}return n},e.parse=function(e,t){var r,n;n=String,"string"==typeof e||e instanceof String||(e=n(e)),g=u,p=0,f=(c=e).length>0?1:0,h=0,d=c.length,y=null,v={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},m={},void 0!==t&&(m.range="boolean"==typeof t.range&&t.range,m.loc="boolean"==typeof t.loc&&t.loc,m.attachComment="boolean"==typeof t.attachComment&&t.attachComment,m.loc&&null!==t.source&&void 0!==t.source&&(m.source=n(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(m.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(m.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(m.errors=[]),m.attachComment&&(m.range=!0,m.comments=[],m.bottomRightStack=[],m.trailingComments=[],m.leadingComments=[]));try{r=Ce(),void 0!==m.comments&&(r.comments=m.comments),void 0!==m.tokens&&(Re(),r.tokens=m.tokens),void 0!==m.errors&&(r.errors=m.errors)}catch(e){throw e}finally{m={}}return r},e.Syntax=function(){var e,t={};for(e in"function"==typeof Object.create&&(t=Object.create(null)),i)i.hasOwnProperty(e)&&(t[e]=i[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()}))},{}],1:[function(e,t,r){(function(n){var i=function(){var e={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(e,r,n,i,o,s,a){i.ast||(i.ast=t,t.initialize());var u=s.length-1;switch(o){case 1:return i.ast.set({expression:{type:"root",value:s[u]}}),i.ast.unshift(),i.ast.yield();case 2:return i.ast.set({expression:{type:"root",value:s[u-1]}}),i.ast.unshift(),i.ast.yield();case 3:return i.ast.unshift(),i.ast.yield();case 4:return i.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:s[u-1]}}),i.ast.unshift(),i.ast.yield();case 5:case 6:break;case 7:i.ast.set({operation:"member"}),i.ast.push();break;case 8:i.ast.set({operation:"subscript"}),i.ast.push();break;case 9:i.ast.set({scope:"child"});break;case 10:i.ast.set({scope:"descendant"});break;case 11:break;case 12:i.ast.set({scope:"child",operation:"member"});break;case 13:break;case 14:i.ast.set({expression:{type:"wildcard",value:s[u]}});break;case 15:i.ast.set({expression:{type:"identifier",value:s[u]}});break;case 16:i.ast.set({expression:{type:"script_expression",value:s[u]}});break;case 17:i.ast.set({expression:{type:"numeric_literal",value:parseInt(s[u])}});break;case 18:break;case 19:i.ast.set({scope:"child"});break;case 20:i.ast.set({scope:"descendant"});break;case 21:case 22:case 23:break;case 24:s[u].length>1?i.ast.set({expression:{type:"union",value:s[u]}}):this.$=s[u];break;case 25:this.$=[s[u]];break;case 26:this.$=s[u-2].concat(s[u]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(s[u])}},i.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:s[u]}},i.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:s[u]}},i.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:s[u]}},i.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:s[u]}},i.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:s[u]}},i.ast.set(this.$);break;case 33:case 34:this.$=s[u]}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],i=[],o=this.table,s="",a=0,u=0,c=0,l=2,p=1,f=i.slice.call(arguments,1);this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;i.push(h);var d=this.lexer.options&&this.lexer.options.ranges;function g(){var e;return"number"!=typeof(e=t.lexer.lex()||p)&&(e=t.symbols_[e]||e),e}"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,v,m,_,b,w,k,S,x,E={};;){if(m=r[r.length-1],this.defaultActions[m]?_=this.defaultActions[m]:(null==y&&(y=g()),_=o[m]&&o[m][y]),void 0===_||!_.length||!_[0]){var I="";for(w in x=[],o[m])this.terminals_[w]&&w>l&&x.push("'"+this.terminals_[w]+"'");I=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(a+1)+": Unexpected "+(y==p?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(I,{text:this.lexer.match,token:this.terminals_[y]||y,line:this.lexer.yylineno,loc:h,expected:x})}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+y);switch(_[0]){case 1:r.push(y),n.push(this.lexer.yytext),i.push(this.lexer.yylloc),r.push(_[1]),y=null,v?(y=v,v=null):(u=this.lexer.yyleng,s=this.lexer.yytext,a=this.lexer.yylineno,h=this.lexer.yylloc,c>0&&c--);break;case 2:if(k=this.productions_[_[1]][1],E.$=n[n.length-k],E._$={first_line:i[i.length-(k||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(k||1)].first_column,last_column:i[i.length-1].last_column},d&&(E._$.range=[i[i.length-(k||1)].range[0],i[i.length-1].range[1]]),void 0!==(b=this.performAction.apply(E,[s,u,a,this.yy,_[1],n,i].concat(f))))return b;k&&(r=r.slice(0,-1*k*2),n=n.slice(0,-1*k),i=i.slice(0,-1*k)),r.push(this.productions_[_[1]][0]),n.push(E.$),i.push(E._$),S=o[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},t={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(e){for(var t in e)this._node[t]=e[t];return this._node},node:function(e){return arguments.length&&(this._node=e),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var e=this._nodes;return this.initialize(),e}},r={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((r=this._input.match(this.rules[i[o]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,i[o])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return t.yytext=t.yytext.substr(1,t.yyleng-2),32;case 11:return t.yytext=t.yytext.substr(1,t.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function n(){this.yy={}}return e.lexer=r,n.prototype=e,e.Parser=n,new n}();void 0!==e&&void 0!==r&&(r.parser=i,r.Parser=i.Parser,r.parse=function(){return i.parse.apply(i,arguments)},r.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),n.exit(1));var i=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return r.parser.parse(i)},void 0!==t&&e.main===t&&r.main(n.argv.slice(1)))}).call(this,e("_process"))},{_process:14,fs:12,path:13}],2:[function(e,t,r){t.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(e,t,r){var n=e("./dict"),i=e("fs"),o={lex:{macros:{esc:"\\\\",int:n.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[n.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[n.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[n.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};i.readFileSync&&(o.moduleInclude=i.readFileSync(e.resolve("../include/module.js")),o.actionInclude=i.readFileSync(e.resolve("../include/action.js"))),t.exports=o},{"./dict":2,fs:12}],4:[function(e,t,r){var n=e("./aesprim"),i=e("./slice"),o=e("static-eval"),s=e("underscore").uniq,a=function(){return this.initialize.apply(this,arguments)};function u(t,r,i){var o=e("./index"),s=h(n.parse(r).body[0].expression,{"@":t.value}),a=i.replace(/\{\{\s*value\s*\}\}/g,s),u=o.nodes(t.value,a);return u.forEach((function(e){e.path=t.path.concat(e.path.slice(1))})),u}function c(e){return Array.isArray(e)}function l(e){return function(t,r,n,i){var o=t.value,s=t.path,a=[],u=function(t,o){var s;c(t)?(t.forEach((function(e,t){a.length>=i||n(t,e,r)&&a.push({path:o.concat(t),value:e})})),t.forEach((function(t,r){a.length>=i||e&&u(t,o.concat(r))}))):(s=t)&&!(s instanceof Array)&&s instanceof Object&&(this.keys(t).forEach((function(e){a.length>=i||n(e,t[e],r)&&a.push({path:o.concat(e),value:t[e]})})),this.keys(t).forEach((function(r){a.length>=i||e&&u(t[r],o.concat(r))})))}.bind(this);return u(o,s),a}}function p(e){return function(t,r,n){return this.descend(r,t.expression.value,e,n)}}function f(e){return function(t,r,n){return this.traverse(r,t.expression.value,e,n)}}function h(){try{return o.apply(this,arguments)}catch(e){}}function d(e){return e=e.filter((function(e){return e})),s(e,(function(e){return e.path.map((function(e){return String(e).replace("-","--")})).join("-")}))}function g(e){var t=String(e);return t.match(/^-?[0-9]+$/)?parseInt(t):null}a.prototype.initialize=function(){this.traverse=l(!0),this.descend=l()},a.prototype.keys=Object.keys,a.prototype.resolve=function(e){var t=[e.operation,e.scope,e.expression.type].join("-"),r=this._fns[t];if(!r)throw new Error("couldn't resolve key: "+t);return r.bind(this)},a.prototype.register=function(e,t){if(!t instanceof Function)throw new Error("handler must be a function");this._fns[e]=t},a.prototype._fns={"member-child-identifier":function(e,t){var r=e.expression.value,n=t.value;if(n instanceof Object&&r in n)return[{value:n[r],path:t.path.concat(r)}]},"member-descendant-identifier":f((function(e,t,r){return e==r})),"subscript-child-numeric_literal":p((function(e,t,r){return e===r})),"member-child-numeric_literal":p((function(e,t,r){return String(e)===String(r)})),"subscript-descendant-numeric_literal":f((function(e,t,r){return e===r})),"member-child-wildcard":p((function(){return!0})),"member-descendant-wildcard":f((function(){return!0})),"subscript-descendant-wildcard":f((function(){return!0})),"subscript-child-wildcard":p((function(){return!0})),"subscript-child-slice":function(e,t){if(c(t.value)){var r=e.expression.value.split(":").map(g),n=t.value.map((function(e,r){return{value:e,path:t.path.concat(r)}}));return i.apply(null,[n].concat(r))}},"subscript-child-union":function(e,t){var r=[];return e.expression.value.forEach((function(e){var n={operation:"subscript",scope:"child",expression:e.expression},i=this.resolve(n)(n,t);i&&(r=r.concat(i))}),this),d(r)},"subscript-descendant-union":function(t,r,n){var i=e(".."),o=this,s=[];return i.nodes(r,"$..*").slice(1).forEach((function(e){s.length>=n||t.expression.value.forEach((function(t){var r={operation:"subscript",scope:"child",expression:t.expression},n=o.resolve(r)(r,e);s=s.concat(n)}))})),d(s)},"subscript-child-filter_expression":function(e,t,r){var i=e.expression.value.slice(2,-1),o=n.parse(i).body[0].expression;return this.descend(t,null,(function(e,t){return h(o,{"@":t})}),r)},"subscript-descendant-filter_expression":function(e,t,r){var i=e.expression.value.slice(2,-1),o=n.parse(i).body[0].expression;return this.traverse(t,null,(function(e,t){return h(o,{"@":t})}),r)},"subscript-child-script_expression":function(e,t){return u(t,e.expression.value.slice(1,-1),"$[{{value}}]")},"member-child-script_expression":function(e,t){return u(t,e.expression.value.slice(1,-1),"$.{{value}}")},"member-descendant-script_expression":function(e,t){return u(t,e.expression.value.slice(1,-1),"$..value")}},a.prototype._fns["subscript-child-string_literal"]=a.prototype._fns["member-child-identifier"],a.prototype._fns["member-descendant-numeric_literal"]=a.prototype._fns["subscript-descendant-string_literal"]=a.prototype._fns["member-descendant-identifier"],t.exports=a},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(e,t,r){var n=e("assert"),i=e("./dict"),o=e("./parser"),s=e("./handlers"),u=function(){this.initialize.apply(this,arguments)};function c(e){return"[object String]"==Object.prototype.toString.call(e)}u.prototype.initialize=function(){this.parser=new o,this.handlers=new s},u.prototype.parse=function(e){return n.ok(c(e),"we need a path"),this.parser.parse(e)},u.prototype.parent=function(e,t){n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path");var r=this.nodes(e,t)[0];return r.path.pop(),this.value(e,r.path)},u.prototype.apply=function(e,t,r){n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),n.equal(a(r),"function","fn needs to be function");var i=this.nodes(e,t).sort((function(e,t){return t.path.length-e.path.length}));return i.forEach((function(t){var n=t.path.pop(),i=this.value(e,this.stringify(t.path)),o=t.value=r.call(e,i[n]);i[n]=o}),this),i},u.prototype.value=function(e,t,r){if(n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),arguments.length>=3){var i=this.nodes(e,t).shift();if(!i)return this._vivify(e,t,r);var o=i.path.slice(-1).shift(),s=this.parent(e,this.stringify(i.path));s[o]=r}return this.query(e,this.stringify(t),1).shift()},u.prototype._vivify=function(e,t,r){var i=this;return n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),function t(r,n){var o=r.pop(),s=i.value(e,r);s||(t(r.concat(),"string"==typeof o?{}:[]),s=i.value(e,r)),s[o]=n}(this.parser.parse(t).map((function(e){return e.expression.value})),r),this.query(e,t)[0]},u.prototype.query=function(e,t,r){return n.ok(e instanceof Object,"obj needs to be an object"),n.ok(c(t),"we need a path"),this.nodes(e,t,r).map((function(e){return e.value}))},u.prototype.paths=function(e,t,r){return n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),this.nodes(e,t,r).map((function(e){return e.path}))},u.prototype.nodes=function(e,t,r){if(n.ok(e instanceof Object,"obj needs to be an object"),n.ok(t,"we need a path"),0===r)return[];var i=this.parser.parse(t),o=this.handlers,s=[{path:["$"],value:e}],a=[];return i.length&&"root"==i[0].expression.type&&i.shift(),i.length?(i.forEach((function(e,t){if(!(a.length>=r)){var n=o.resolve(e),u=[];s.forEach((function(o){if(!(a.length>=r)){var s=n(e,o,r);t==i.length-1?a=a.concat(s||[]):u=u.concat(s||[])}})),s=u}})),r?a.slice(0,r):a):s},u.prototype.stringify=function(e){n.ok(e,"we need a path");var t="$",r={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return(e=this._normalize(e)).forEach((function(e){if("root"!=e.expression.type){var n,i=[e.scope,e.operation].join("-"),o=r[i];if(n="string_literal"==e.expression.type?JSON.stringify(e.expression.value):e.expression.value,!o)throw new Error("couldn't find template "+i);t+=o.replace(/{{value}}/,n)}})),t},u.prototype._normalize=function(e){if(n.ok(e,"we need a path"),"string"==typeof e)return this.parser.parse(e);if(Array.isArray(e)&&"string"==typeof e[0]){var t=[{expression:{type:"root",value:"$"}}];return e.forEach((function(e,r){if("$"!=e||0!==r)if("string"==typeof e&&e.match("^"+i.identifier+"$"))t.push({operation:"member",scope:"child",expression:{value:e,type:"identifier"}});else{var n="number"==typeof e?"numeric_literal":"string_literal";t.push({operation:"subscript",scope:"child",expression:{value:e,type:n}})}})),t}if(Array.isArray(e)&&"object"==a(e[0]))return e;throw new Error("couldn't understand path "+e)},u.Handlers=s,u.Parser=o;var l=new u;l.JSONPath=u,t.exports=l},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(e,t,r){var n=e("./grammar"),i=e("../generated/parser"),o=function(){var e=new i.Parser,t=e.parseError;return e.yy.parseError=function(){e.yy.ast&&e.yy.ast.initialize(),t.apply(e,arguments)},e};o.grammar=n,t.exports=o},{"../generated/parser":1,"./grammar":3}],7:[function(e,t,r){function n(e){return String(e).match(/^[0-9]+$/)?parseInt(e):Number.isFinite(e)?parseInt(e,10):0}t.exports=function(e,t,r,i){if("string"==typeof t)throw new Error("start cannot be a string");if("string"==typeof r)throw new Error("end cannot be a string");if("string"==typeof i)throw new Error("step cannot be a string");var o=e.length;if(0===i)throw new Error("step cannot be zero");if(i=i?n(i):1,r=r<0?o+r:r,t=n(0===(t=t<0?o+t:t)?0:t||(i>0?0:o-1)),r=n(0===r?0:r||(i>0?o:-1)),t=i>0?Math.max(0,t):Math.min(o,t),r=i>0?Math.min(r,o):Math.max(-1,r),i>0&&r<=t)return[];if(i<0&&t<=r)return[];for(var s=[],a=t;a!=r&&!(i<0&&a<=r||i>0&&a>=r);a+=i)s.push(e[a]);return s}},{}],8:[function(e,t,r){var n=e("util/"),i=Array.prototype.slice,o=Object.prototype.hasOwnProperty,s=t.exports=l;function a(e,t){return n.isUndefined(t)?""+t:n.isNumber(t)&&!isFinite(t)||n.isFunction(t)||n.isRegExp(t)?t.toString():t}function u(e,t){return n.isString(e)?e.length<t?e:e.slice(0,t):e}function c(e,t,r,n,i){throw new s.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function l(e,t){e||c(e,!0,t,"==",s.ok)}function p(e,t){if(e===t)return!0;if(n.isBuffer(e)&&n.isBuffer(t)){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return n.isDate(e)&&n.isDate(t)?e.getTime()===t.getTime():n.isRegExp(e)&&n.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:n.isObject(e)||n.isObject(t)?function(e,t){if(n.isNullOrUndefined(e)||n.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(n.isPrimitive(e)||n.isPrimitive(t))return e===t;var r=f(e),o=f(t);if(r&&!o||!r&&o)return!1;if(r)return e=i.call(e),t=i.call(t),p(e,t);var s,a,u=g(e),c=g(t);if(u.length!=c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!=c[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!p(e[s],t[s]))return!1;return!0}(e,t):e==t}function f(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function h(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function d(e,t,r,i){var o;n.isString(r)&&(i=r,r=null);try{t()}catch(e){o=e}if(i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),e&&!o&&c(o,r,"Missing expected exception"+i),!e&&h(o,r)&&c(o,r,"Got unwanted exception"+i),e&&o&&r&&!h(o,r)||!e&&o)throw o}s.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return u(JSON.stringify(e.actual,a),128)+" "+e.operator+" "+u(JSON.stringify(e.expected,a),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||c;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,i=t.name,o=n.indexOf("\n"+i);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}},n.inherits(s.AssertionError,Error),s.fail=c,s.ok=l,s.equal=function(e,t,r){e!=t&&c(e,t,r,"==",s.equal)},s.notEqual=function(e,t,r){e==t&&c(e,t,r,"!=",s.notEqual)},s.deepEqual=function(e,t,r){p(e,t)||c(e,t,r,"deepEqual",s.deepEqual)},s.notDeepEqual=function(e,t,r){p(e,t)&&c(e,t,r,"notDeepEqual",s.notDeepEqual)},s.strictEqual=function(e,t,r){e!==t&&c(e,t,r,"===",s.strictEqual)},s.notStrictEqual=function(e,t,r){e===t&&c(e,t,r,"!==",s.notStrictEqual)},s.throws=function(e,t,r){d.apply(this,[!0].concat(i.call(arguments)))},s.doesNotThrow=function(e,t){d.apply(this,[!1].concat(i.call(arguments)))},s.ifError=function(e){if(e)throw e};var g=Object.keys||function(e){var t=[];for(var r in e)o.call(e,r)&&t.push(r);return t}},{"util/":11}],9:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],10:[function(e,t,r){t.exports=function(e){return e&&"object"===a(e)&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],11:[function(e,t,n){(function(t,r){var i=/%[sdj%]/g;n.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<o;a=n[++r])y(a)||!w(a)?s+=" "+a:s+=" "+u(a);return s},n.deprecate=function(e,i){if(_(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,s={};function u(e,t){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(t)?r.showHidden=t:t&&n._extend(r,t),_(r.showHidden)&&(r.showHidden=!1),_(r.depth)&&(r.depth=2),_(r.colors)&&(r.colors=!1),_(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),p(r,e,r.depth)}function c(e,t){var r=u.styles[t];return r?"["+u.colors[r][0]+"m"+e+"["+u.colors[r][1]+"m":e}function l(e,t){return e}function p(e,t,r){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return m(i)||(i=p(e,i,r)),i}var o=function(e,t){if(_(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return v(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}(e,t);if(o)return o;var s=Object.keys(t),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),S(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(t);if(0===s.length){if(x(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(S(t))return f(t)}var c,l="",w=!1,E=["{","}"];return d(t)&&(w=!0,E=["[","]"]),x(t)&&(l=" [Function"+(t.name?": "+t.name:"")+"]"),b(t)&&(l=" "+RegExp.prototype.toString.call(t)),k(t)&&(l=" "+Date.prototype.toUTCString.call(t)),S(t)&&(l=" "+f(t)),0!==s.length||w&&0!=t.length?r<0?b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=w?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)C(t,String(s))?o.push(h(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(h(e,t,r,n,i,!0))})),o}(e,t,r,a,s):s.map((function(n){return h(e,t,r,a,n,w)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(c,l,E)):E[0]+l+E[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,n,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),C(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=y(r)?p(e,u.value,null):p(e,u.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),_(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function v(e){return"number"==typeof e}function m(e){return"string"==typeof e}function _(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===E(e)}function w(e){return"object"===a(e)&&null!==e}function k(e){return w(e)&&"[object Date]"===E(e)}function S(e){return w(e)&&("[object Error]"===E(e)||e instanceof Error)}function x(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(_(o)&&(o=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=t.pid;s[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else s[e]=function(){};return s[e]},n.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=y,n.isNullOrUndefined=function(e){return null==e},n.isNumber=v,n.isString=m,n.isSymbol=function(e){return"symbol"===a(e)},n.isUndefined=_,n.isRegExp=b,n.isObject=w,n.isDate=k,n.isError=S,n.isFunction=x,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===a(e)||void 0===e},n.isBuffer=e("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){console.log("%s - %s",T(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("_process"),void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(e,t,r){},{}],13:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return(i?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!i).join("/"))||"."},r.normalize=function(e){var o=r.isAbsolute(e),s="/"===i(e,-1);return(e=t(n(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&s&&(e+="/"),(o?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var i=n(e.split("/")),o=n(t.split("/")),s=Math.min(i.length,o.length),a=s,u=0;u<s;u++)if(i[u]!==o[u]){a=u;break}var c=[];for(u=a;u<i.length;u++)c.push("..");return(c=c.concat(o.slice(a))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,i=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!i){n=o;break}}else i=!1;return-1===n?r?"/":".":r&&1===n?"/":e.slice(0,n)},r.basename=function(e,t){var r=function(e){"string"!=typeof e&&(e+="");var t,r=0,n=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){r=t+1;break}}else-1===n&&(i=!1,n=t+1);return-1===n?"":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,i=!0,o=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(47!==a)-1===n&&(i=!1,n=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){r=s+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n)};var i="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:14}],14:[function(e,t,r){var n,i,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var c,l=[],p=!1,f=-1;function h(){p&&c&&(p=!1,c.length?l=c.concat(l):f=-1,l.length&&d())}function d(){if(!p){var e=u(h);p=!0;for(var t=l.length;t;){for(c=l,l=[];++f<t;)c&&c[f].run();f=-1,t=l.length}c=null,p=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new g(e,t)),1!==l.length||p||u(d)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],15:[function(e,t,r){var n=e("escodegen").generate;t.exports=function(e,t){t||(t={});var r={},i=function e(i,o){if("Literal"===i.type)return i.value;if("UnaryExpression"===i.type){var s=e(i.argument);return"+"===i.operator?+s:"-"===i.operator?-s:"~"===i.operator?~s:"!"===i.operator?!s:r}if("ArrayExpression"===i.type){for(var a=[],u=0,c=i.elements.length;u<c;u++){if((v=e(i.elements[u]))===r)return r;a.push(v)}return a}if("ObjectExpression"===i.type){var l={};for(u=0;u<i.properties.length;u++){var p=null===(m=i.properties[u]).value?m.value:e(m.value);if(p===r)return r;l[m.key.value||m.key.name]=p}return l}if("BinaryExpression"===i.type||"LogicalExpression"===i.type){if((c=e(i.left))===r)return r;var f=e(i.right);if(f===r)return r;var h=i.operator;return"=="===h?c==f:"==="===h?c===f:"!="===h?c!=f:"!=="===h?c!==f:"+"===h?c+f:"-"===h?c-f:"*"===h?c*f:"/"===h?c/f:"%"===h?c%f:"<"===h?c<f:"<="===h?c<=f:">"===h?c>f:">="===h?c>=f:"|"===h?c|f:"&"===h?c&f:"^"===h?c^f:"&&"===h?c&&f:"||"===h?c||f:r}if("Identifier"===i.type)return{}.hasOwnProperty.call(t,i.name)?t[i.name]:r;if("ThisExpression"===i.type)return{}.hasOwnProperty.call(t,"this")?t.this:r;if("CallExpression"===i.type){var d=e(i.callee);if(d===r)return r;if("function"!=typeof d)return r;var g=i.callee.object?e(i.callee.object):r;g===r&&(g=null);var y=[];for(u=0,c=i.arguments.length;u<c;u++){var v;if((v=e(i.arguments[u]))===r)return r;y.push(v)}return d.apply(g,y)}var m;if("MemberExpression"===i.type)return(l=e(i.object))===r||"function"==typeof l?r:"Identifier"===i.property.type?l[i.property.name]:(m=e(i.property))===r?r:l[m];if("ConditionalExpression"===i.type)return(s=e(i.test))===r?r:e(s?i.consequent:i.alternate);if("ExpressionStatement"===i.type)return(s=e(i.expression))===r?r:s;if("ReturnStatement"===i.type)return e(i.argument);if("FunctionExpression"===i.type){var _=i.body.body,b={};for(Object.keys(t).forEach((function(e){b[e]=t[e]})),u=0;u<i.params.length;u++){var w=i.params[u];if("Identifier"!=w.type)return r;t[w.name]=null}for(var u in _)if(e(_[u])===r)return r;t=b;var k=Object.keys(t),S=k.map((function(e){return t[e]}));return Function(k.join(", "),"return "+n(i)).apply(null,S)}if("TemplateLiteral"===i.type){var x="";for(u=0;u<i.expressions.length;u++)x+=e(i.quasis[u]),x+=e(i.expressions[u]);return x+=e(i.quasis[u])}if("TaggedTemplateExpression"===i.type){var E=e(i.tag),I=i.quasi,O=I.quasis.map(e),T=I.expressions.map(e);return E.apply(null,[O].concat(T))}return"TemplateElement"===i.type?i.value.cooked:r}(e);return i===r?void 0:i}},{escodegen:12}],jsonpath:[function(e,t,r){t.exports=e("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")},"object"===a(t)&&void 0!==e?e.exports=s():(i=[],void 0===(o="function"==typeof(n=s)?n.apply(t,i):n)||(e.exports=o))}).call(this,r(8))},function(e,t,r){var n=r(1),i=r(6).AuthenticatedProviderNode,o=r(9).LogoutNode,s=r(10).SetCurrentUserNode,a=r(11).SetAccessTokenNode,u=r(12).LoginNode,c=r(13).AuthenticatedGuardNode;n.defineModule({reactNodes:[i,c,s,a,o,u],nodes:[],setup:function(){}})},function(e,t,r){var n=r(1),i=r(0),o=(i.useEffect,i.useState,r(2)),s=o.AuthProvider;o.useAuth,r(4),r(3).jwtDecode;var a=function(e){var t=e.children,r=e.authority,n=void 0===r?"http://localhost:9000/realms/test":r,i=e.client_id,o=void 0===i?"test":i,a=e.redirect_uri,u=void 0===a?"http://localhost:8574/test":a;return React.createElement(s,{authority:n,client_id:o,redirect_uri:u,onSigninCallback:function(e){window.history.replaceState({},document.title,window.location.pathname)}},t)},u=n.defineReactNode({name:"Oidc Authentication Provider",category:"Tutorial",getReactComponent:function(){return a},inputProps:{authority:{type:"string",default:"http://localhost:9000/realms/test",displayName:"Authority"},client_id:{type:"string",default:"test",displayName:"Cliend ID"},redirect_uri:{type:"string",default:"http://localhost:8574",displayName:"Redirect URI"},audience:{type:"string",default:"test",displayName:"Audience"},role_claim_json_path:{type:"string",default:"roles",displayName:"Role Claim"},required_roles:{type:"string",default:"",displayName:"Required Roles"}},outputProps:{currentUser:{type:"data",displayName:"Current User"},hasResourceAccess:{type:"data",displayName:"Has Resource access"}}});e.exports={AuthenticatedProviderNode:u}},function(e,t,r){"use strict";var n=["timeoutInSeconds"],i=["grant_type","redirect_uri","client_id","client_secret"],o=["grant_type","client_id","client_secret","scope"],s=["grant_type","client_id","client_secret","timeoutInSeconds"],a=["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","url_state","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE"],u=["redirectMethod"],c=["popupWindowFeatures","popupWindowTarget"],l=["silentRequestTimeoutInSeconds"],p=["silentRequestTimeoutInSeconds"],f=["redirectMethod"],h=["popupWindowFeatures","popupWindowTarget"],d=["silentRequestTimeoutInSeconds"];function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=M(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _(e){var t="function"==typeof Map?new Map:void 0;return(_=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return b(e,arguments,O(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),x(r,e)})(e)}function b(e,t,r){if(k())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&x(i,r.prototype),i}function w(e,t,r){return t=O(t),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,k()?Reflect.construct(t,r||[],O(e).constructor):t.apply(e,r))}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=I(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function I(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||q(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}function R(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */R=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof y?t:y,s=Object.create(o.prototype),a=new C(n||[]);return i(s,"_invoke",{value:E(e,r,a)}),s}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",h="executing",d="completed",g={};function y(){}function v(){}function m(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(P([])));w&&w!==r&&n.call(w,s)&&(_=w);var k=m.prototype=y.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,o,s,a){var u=p(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==$(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,a)}))}a(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function E(t,r,n){var i=f;return function(o,s){if(i===h)throw Error("Generator is already running");if(i===d){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=I(a,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var c=p(t,r,n);if("normal"===c.type){if(i=n.done?d:"suspendedYield",c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=d,n.method="throw",n.arg=c.arg)}}}function I(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError($(t)+" is not iterable")}return v.prototype=m,i(k,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:v,configurable:!0}),v.displayName=c(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},S(x.prototype),c(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new x(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(k),c(k,u,"Generator"),c(k,s,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function P(e,t,r,n,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){P(o,n,i,s,a,"next",e)}function a(e){P(o,n,i,s,a,"throw",e)}s(void 0)}))}}function A(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M(n.key),n)}}function U(e,t,r){return t&&L(e.prototype,t),r&&L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}function D(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=q(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function q(e,t){if(e){if("string"==typeof e)return F(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var B,H=Object.defineProperty,W=Object.getOwnPropertyDescriptor,z=Object.getOwnPropertyNames,G=Object.prototype.hasOwnProperty,K={};!function(e,t){for(var r in t)H(e,r,{get:t[r],enumerable:!0})}(K,{AccessTokenEvents:function(){return le},CheckSessionIFrame:function(){return pe},ErrorResponse:function(){return ue},ErrorTimeout:function(){return ce},InMemoryWebStorage:function(){return fe},Log:function(){return Y},Logger:function(){return Z},MetadataService:function(){return de},OidcClient:function(){return Re},OidcClientSettingsStore:function(){return ye},SessionMonitor:function(){return Pe},SigninResponse:function(){return xe},SigninState:function(){return we},SignoutResponse:function(){return Ie},State:function(){return be},User:function(){return Ne},UserManager:function(){return We},UserManagerSettingsStore:function(){return Le},Version:function(){return ze},WebStorageStateStore:function(){return ge}}),e.exports=(B=K,function(e,t,r,n){if(t&&"object"===$(t)||"function"==typeof t){var i,o=D(z(t));try{var s=function(){var o=i.value;G.call(e,o)||o===r||H(e,o,{get:function(){return t[o]},enumerable:!(n=W(t,o))||n.enumerable})};for(o.s();!(i=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}}return e}(H({},"__esModule",{value:!0}),B));var J,X,V,Q={debug:function(){},info:function(){},warn:function(){},error:function(){}},Y=function(e){return e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e}(Y||{});(V=Y||(Y={})).reset=function(){J=3,X=Q},V.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");J=e},V.setLogger=function(e){X=e};var Z=function(){function e(t){j(this,e),this._name=t}return U(e,[{key:"debug",value:function(){if(J>=4){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=X).debug.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"info",value:function(){if(J>=3){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=X).info.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"warn",value:function(){if(J>=2){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=X).warn.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"error",value:function(){if(J>=1){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=X).error.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"throw",value:function(e){throw this.error(e),e}},{key:"create",value:function(e){var t=Object.create(this);return t._method=e,t.debug("begin"),t}}],[{key:"createStatic",value:function(t,r){var n=new e("".concat(t,".").concat(r));return n.debug("begin"),n}},{key:"_format",value:function(e,t){var r="[".concat(e,"]");return t?"".concat(r," ").concat(t,":"):r}},{key:"debug",value:function(t){if(J>=4){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(r=X).debug.apply(r,[e._format(t)].concat(i))}}},{key:"info",value:function(t){if(J>=3){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(r=X).info.apply(r,[e._format(t)].concat(i))}}},{key:"warn",value:function(t){if(J>=2){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(r=X).warn.apply(r,[e._format(t)].concat(i))}}},{key:"error",value:function(t){if(J>=1){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(r=X).error.apply(r,[e._format(t)].concat(i))}}}])}();Y.reset();var ee=function(e){return btoa(A(new Uint8Array(e)).map((function(e){return String.fromCharCode(e)})).join(""))},te=function(){function e(){j(this,e)}return U(e,null,[{key:"_randomWord",value:function(){var e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}},{key:"generateUUIDv4",value:function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(+t^e._randomWord()&15>>+t/4).toString(16)})).replace(/-/g,"")}},{key:"generateCodeVerifier",value:function(){return e.generateUUIDv4()+e.generateUUIDv4()+e.generateUUIDv4()}},{key:"generateCodeChallenge",value:(t=N(R().mark((function e(t){var r,n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(crypto.subtle){e.next=2;break}throw new Error("Crypto.subtle is available only in secure contexts (HTTPS).");case 2:return e.prev=2,r=new TextEncoder,n=r.encode(t),e.next=7,crypto.subtle.digest("SHA-256",n);case 7:return i=e.sent,e.abrupt("return",ee(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""));case 11:throw e.prev=11,e.t0=e.catch(2),Z.error("CryptoUtils.generateCodeChallenge",e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,11]])}))),function(e){return t.apply(this,arguments)})},{key:"generateBasicAuth",value:function(e,t){var r=(new TextEncoder).encode([e,t].join(":"));return ee(r)}}]);var t}(),re=function(){return U((function e(t){j(this,e),this._name=t,this._logger=new Z("Event('".concat(this._name,"')")),this._callbacks=[]}),[{key:"addHandler",value:function(e){var t=this;return this._callbacks.push(e),function(){return t.removeHandler(e)}}},{key:"removeHandler",value:function(e){var t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}},{key:"raise",value:(e=N(R().mark((function e(){var t,r,n,i,o,s,a,u=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=u.length,n=new Array(r),i=0;i<r;i++)n[i]=u[i];(t=this._logger).debug.apply(t,["raise:"].concat(n)),o=D(this._callbacks),e.prev=3,o.s();case 5:if((s=o.n()).done){e.next=11;break}return a=s.value,e.next=9,a.apply(void 0,n);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),o.e(e.t0);case 16:return e.prev=16,o.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[3,13,16,19]])}))),function(){return e.apply(this,arguments)})}]);var e}(),ne=r(3),ie=function(){return U((function e(){j(this,e)}),null,[{key:"decode",value:function(e){try{return(0,ne.jwtDecode)(e)}catch(e){throw Z.error("JwtUtils.decode",e),e}}}])}(),oe=function(){return U((function e(){j(this,e)}),null,[{key:"center",value:function(e){var t,r=C({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return null==r.width&&(r.width=null!=(t=[800,720,600,480].find((function(e){return e<=window.outerWidth/1.618})))?t:360),null!=r.left||(r.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-r.width)/2))),null!=r.height&&(null!=r.top||(r.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-r.height)/2)))),r}},{key:"serialize",value:function(e){return Object.entries(e).filter((function(e){return null!=T(e,2)[1]})).map((function(e){var t=T(e,2),r=t[0],n=t[1];return"".concat(r,"=").concat("boolean"!=typeof n?n:n?"yes":"no")})).join(",")}}])}(),se=function(e){function t(){var e;return j(this,t),(e=w(this,t,arguments))._logger=new Z("Timer('".concat(e._name,"')")),e._timerHandle=null,e._expiration=0,e._callback=function(){var r=e._expiration-t.getEpochTime();e._logger.debug("timer completes in",r),e._expiration<=t.getEpochTime()&&(e.cancel(),E(O(t.prototype),"raise",e).call(e))},e}return S(t,e),U(t,[{key:"init",value:function(e){var r=this._logger.create("init");e=Math.max(Math.floor(e),1);var n=t.getEpochTime()+e;if(this.expiration===n&&this._timerHandle)r.debug("skipping since already initialized for expiration at",this.expiration);else{this.cancel(),r.debug("using duration",e),this._expiration=n;var i=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*i)}}},{key:"expiration",get:function(){return this._expiration}},{key:"cancel",value:function(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}}],[{key:"getEpochTime",value:function(){return Math.floor(Date.now()/1e3)}}])}(re),ae=function(){return U((function e(){j(this,e)}),null,[{key:"readParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";if(!e)throw new TypeError("Invalid URL");var r=new URL(e,"http://127.0.0.1"),n=r["fragment"===t?"hash":"search"];return new URLSearchParams(n.slice(1))}}])}(),ue=function(e){function t(e,r){var n,i,o,s;if(j(this,t),(n=w(this,t,[e.error_description||e.error||""])).form=r,n.name="ErrorResponse",!e.error)throw Z.error("ErrorResponse","No error passed"),new Error("No error passed");return n.error=e.error,n.error_description=null!=(i=e.error_description)?i:null,n.error_uri=null!=(o=e.error_uri)?o:null,n.state=e.userState,n.session_state=null!=(s=e.session_state)?s:null,n.url_state=e.url_state,n}return S(t,e),U(t)}(_(Error)),ce=function(e){function t(e){var r;return j(this,t),(r=w(this,t,[e])).name="ErrorTimeout",r}return S(t,e),U(t)}(_(Error)),le=function(){return U((function e(t){j(this,e),this._logger=new Z("AccessTokenEvents"),this._expiringTimer=new se("Access token expiring"),this._expiredTimer=new se("Access token expired"),this._expiringNotificationTimeInSeconds=t.expiringNotificationTimeInSeconds}),[{key:"load",value:function(e){var t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){var r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){var n=r-this._expiringNotificationTimeInSeconds;n<=0&&(n=1),t.debug("registering expiring timer, raising in",n,"seconds"),this._expiringTimer.init(n)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();var i=r+1;t.debug("registering expired timer, raising in",i,"seconds"),this._expiredTimer.init(i)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}},{key:"unload",value:function(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}},{key:"addAccessTokenExpiring",value:function(e){return this._expiringTimer.addHandler(e)}},{key:"removeAccessTokenExpiring",value:function(e){this._expiringTimer.removeHandler(e)}},{key:"addAccessTokenExpired",value:function(e){return this._expiredTimer.addHandler(e)}},{key:"removeAccessTokenExpired",value:function(e){this._expiredTimer.removeHandler(e)}}])}(),pe=function(){return U((function e(t,r,n,i,o){var s=this;j(this,e),this._callback=t,this._client_id=r,this._intervalInSeconds=i,this._stopOnError=o,this._logger=new Z("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=function(e){e.origin===s._frame_origin&&e.source===s._frame.contentWindow&&("error"===e.data?(s._logger.error("error message from check session op iframe"),s._stopOnError&&s.stop()):"changed"===e.data?(s._logger.debug("changed message from check session op iframe"),s.stop(),s._callback()):s._logger.debug(e.data+" message from check session op iframe"))};var a=new URL(n);this._frame_origin=a.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=a.href}),[{key:"load",value:function(){var e=this;return new Promise((function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),window.addEventListener("message",e._message,!1)}))}},{key:"start",value:function(e){var t=this;if(this._session_state!==e){this._logger.create("start"),this.stop(),this._session_state=e;var r=function(){t._frame.contentWindow&&t._session_state&&t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};r(),this._timer=setInterval(r,1e3*this._intervalInSeconds)}}},{key:"stop",value:function(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}}])}(),fe=function(){return U((function e(){j(this,e),this._logger=new Z("InMemoryWebStorage"),this._data={}}),[{key:"clear",value:function(){this._logger.create("clear"),this._data={}}},{key:"getItem",value:function(e){return this._logger.create("getItem('".concat(e,"')")),this._data[e]}},{key:"setItem",value:function(e,t){this._logger.create("setItem('".concat(e,"')")),this._data[e]=t}},{key:"removeItem",value:function(e){this._logger.create("removeItem('".concat(e,"')")),delete this._data[e]}},{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}},{key:"key",value:function(e){return Object.getOwnPropertyNames(this._data)[e]}}])}(),he=function(){return U((function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};j(this,e),this._jwtHandler=n,this._extraHeaders=i,this._logger=new Z("JsonService"),this._contentTypes=[],(t=this._contentTypes).push.apply(t,A(r).concat(["application/json"])),n&&this._contentTypes.push("application/jwt")}),[{key:"fetchWithTimeout",value:(r=N(R().mark((function e(t){var r,i,o,s,a,u,c=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:{},i=r.timeoutInSeconds,o=m(r,n),i){e.next=6;break}return e.next=5,fetch(t,o);case 5:return e.abrupt("return",e.sent);case 6:return s=new AbortController,a=setTimeout((function(){return s.abort()}),1e3*i),e.prev=8,e.next=11,fetch(t,y(y({},r),{},{signal:s.signal}));case 11:return u=e.sent,e.abrupt("return",u);case 15:if(e.prev=15,e.t0=e.catch(8),!(e.t0 instanceof DOMException&&"AbortError"===e.t0.name)){e.next=19;break}throw new ce("Network timed out");case 19:throw e.t0;case 20:return e.prev=20,clearTimeout(a),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[8,15,20,23]])}))),function(e){return r.apply(this,arguments)})},{key:"getJson",value:(t=N(R().mark((function e(t){var r,n,i,o,s,a,u,c,l=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:{},n=r.token,i=r.credentials,o=this._logger.create("getJson"),s={Accept:this._contentTypes.join(", ")},n&&(o.debug("token passed, setting Authorization header"),s.Authorization="Bearer "+n),this.appendExtraHeaders(s),e.prev=5,o.debug("url:",t),e.next=9,this.fetchWithTimeout(t,{method:"GET",headers:s,credentials:i});case 9:a=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(5),o.error("Network Error"),e.t0;case 16:if(o.debug("HTTP response received, status",a.status),(u=a.headers.get("Content-Type"))&&!this._contentTypes.find((function(e){return u.startsWith(e)}))&&o.throw(new Error("Invalid response Content-Type: ".concat(null!=u?u:"undefined",", from URL: ").concat(t))),!(a.ok&&this._jwtHandler&&(null==u?void 0:u.startsWith("application/jwt")))){e.next=27;break}return e.t1=this,e.next=23,a.text();case 23:return e.t2=e.sent,e.next=26,e.t1._jwtHandler.call(e.t1,e.t2);case 26:return e.abrupt("return",e.sent);case 27:return e.prev=27,e.next=30,a.json();case 30:c=e.sent,e.next=39;break;case 33:if(e.prev=33,e.t3=e.catch(27),o.error("Error parsing JSON response",e.t3),!a.ok){e.next=38;break}throw e.t3;case 38:throw new Error("".concat(a.statusText," (").concat(a.status,")"));case 39:if(a.ok){e.next=44;break}if(o.error("Error from server:",c),!c.error){e.next=43;break}throw new ue(c);case 43:throw new Error("".concat(a.statusText," (").concat(a.status,"): ").concat(JSON.stringify(c)));case 44:return e.abrupt("return",c);case 45:case"end":return e.stop()}}),e,this,[[5,12],[27,33]])}))),function(e){return t.apply(this,arguments)})},{key:"postForm",value:(e=N(R().mark((function e(t,r){var n,i,o,s,a,u,c,l,p,f;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.body,i=r.basicAuth,o=r.timeoutInSeconds,s=r.initCredentials,a=this._logger.create("postForm"),u={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"},void 0!==i&&(u.Authorization="Basic "+i),this.appendExtraHeaders(u),e.prev=5,a.debug("url:",t),e.next=9,this.fetchWithTimeout(t,{method:"POST",headers:u,body:n,timeoutInSeconds:o,credentials:s});case 9:c=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(5),a.error("Network error"),e.t0;case 16:if(a.debug("HTTP response received, status",c.status),!(l=c.headers.get("Content-Type"))||this._contentTypes.find((function(e){return l.startsWith(e)}))){e.next=20;break}throw new Error("Invalid response Content-Type: ".concat(null!=l?l:"undefined",", from URL: ").concat(t));case 20:return e.next=22,c.text();case 22:if(p=e.sent,f={},!p){e.next=35;break}e.prev=25,f=JSON.parse(p),e.next=35;break;case 29:if(e.prev=29,e.t1=e.catch(25),a.error("Error parsing JSON response",e.t1),!c.ok){e.next=34;break}throw e.t1;case 34:throw new Error("".concat(c.statusText," (").concat(c.status,")"));case 35:if(c.ok){e.next=40;break}if(a.error("Error from server:",f),!f.error){e.next=39;break}throw new ue(f,n);case 39:throw new Error("".concat(c.statusText," (").concat(c.status,"): ").concat(JSON.stringify(f)));case 40:return e.abrupt("return",f);case 41:case"end":return e.stop()}}),e,this,[[5,12],[25,29]])}))),function(t,r){return e.apply(this,arguments)})},{key:"appendExtraHeaders",value:function(e){var t=this,r=this._logger.create("appendExtraHeaders"),n=Object.keys(this._extraHeaders),i=["authorization","accept","content-type"];0!==n.length&&n.forEach((function(n){if(i.includes(n.toLocaleLowerCase()))r.warn("Protected header could not be overridden",n,i);else{var o="function"==typeof t._extraHeaders[n]?t._extraHeaders[n]():t._extraHeaders[n];o&&""!==o&&(e[n]=o)}}))}}]);var e,t,r}(),de=function(){return U((function e(t){j(this,e),this._settings=t,this._logger=new Z("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new he(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}),[{key:"resetSigningKeys",value:function(){this._signingKeys=null}},{key:"getMetadata",value:(r=N(R().mark((function e(){var t,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("getMetadata"),!this._metadata){e.next=4;break}return t.debug("using cached values"),e.abrupt("return",this._metadata);case 4:if(this._metadataUrl){e.next=7;break}throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;case 7:return t.debug("getting metadata from",this._metadataUrl),e.next=10,this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});case 10:return r=e.sent,t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,r),e.abrupt("return",this._metadata);case 14:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getIssuer",value:function(){return this._getMetadataProperty("issuer")}},{key:"getAuthorizationEndpoint",value:function(){return this._getMetadataProperty("authorization_endpoint")}},{key:"getUserInfoEndpoint",value:function(){return this._getMetadataProperty("userinfo_endpoint")}},{key:"getTokenEndpoint",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)}},{key:"getCheckSessionIframe",value:function(){return this._getMetadataProperty("check_session_iframe",!0)}},{key:"getEndSessionEndpoint",value:function(){return this._getMetadataProperty("end_session_endpoint",!0)}},{key:"getRevocationEndpoint",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("revocation_endpoint",e)}},{key:"getKeysEndpoint",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("jwks_uri",e)}},{key:"_getMetadataProperty",value:(t=N(R().mark((function e(t){var r,n,i,o=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],n=this._logger.create("_getMetadataProperty('".concat(t,"')")),e.next=4,this.getMetadata();case 4:if(i=e.sent,n.debug("resolved"),void 0!==i[t]){e.next=11;break}if(!0!==r){e.next=10;break}return n.warn("Metadata does not contain optional property"),e.abrupt("return",void 0);case 10:n.throw(new Error("Metadata does not contain property "+t));case 11:return e.abrupt("return",i[t]);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getSigningKeys",value:(e=N(R().mark((function e(){var t,r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("getSigningKeys"),!this._signingKeys){e.next=4;break}return t.debug("returning signingKeys from cache"),e.abrupt("return",this._signingKeys);case 4:return e.next=6,this.getKeysEndpoint(!1);case 6:return r=e.sent,t.debug("got jwks_uri",r),e.next=10,this._jsonService.getJson(r);case 10:if(n=e.sent,t.debug("got key set",n),Array.isArray(n.keys)){e.next=15;break}throw t.throw(new Error("Missing keys on keyset")),null;case 15:return this._signingKeys=n.keys,e.abrupt("return",this._signingKeys);case 17:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e,t,r}(),ge=function(){return U((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.prefix,n=void 0===r?"oidc.":r,i=t.store,o=void 0===i?localStorage:i;j(this,e),this._logger=new Z("WebStorageStateStore"),this._store=o,this._prefix=n}),[{key:"set",value:(n=N(R().mark((function e(t,r){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("set('".concat(t,"')")),t=this._prefix+t,e.next=4,this._store.setItem(t,r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"get",value:(r=N(R().mark((function e(t){var r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("get('".concat(t,"')")),t=this._prefix+t,e.next=4,this._store.getItem(t);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"remove",value:(t=N(R().mark((function e(t){var r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("remove('".concat(t,"')")),t=this._prefix+t,e.next=4,this._store.getItem(t);case 4:return r=e.sent,e.next=7,this._store.removeItem(t);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getAllKeys",value:(e=N(R().mark((function e(){var t,r,n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("getAllKeys"),e.next=3,this._store.length;case 3:t=e.sent,r=[],n=0;case 6:if(!(n<t)){e.next=14;break}return e.next=9,this._store.key(n);case 9:(i=e.sent)&&0===i.indexOf(this._prefix)&&r.push(i.substr(this._prefix.length));case 11:n++,e.next=6;break;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e,t,r,n}(),ye=U((function e(t){var r=t.authority,n=t.metadataUrl,i=t.metadata,o=t.signingKeys,s=t.metadataSeed,a=t.client_id,u=t.client_secret,c=t.response_type,l=void 0===c?"code":c,p=t.scope,f=void 0===p?"openid":p,h=t.redirect_uri,d=t.post_logout_redirect_uri,g=t.client_authentication,y=void 0===g?"client_secret_post":g,v=t.prompt,m=t.display,_=t.max_age,b=t.ui_locales,w=t.acr_values,k=t.resource,S=t.response_mode,x=t.filterProtocolClaims,E=void 0===x||x,I=t.loadUserInfo,O=void 0!==I&&I,T=t.staleStateAgeInSeconds,C=void 0===T?900:T,R=t.mergeClaimsStrategy,P=void 0===R?{array:"replace"}:R,N=t.disablePKCE,A=void 0!==N&&N,L=t.stateStore,U=t.revokeTokenAdditionalContentTypes,M=t.fetchRequestCredentials,D=t.refreshTokenAllowedScope,q=t.extraQueryParams,F=void 0===q?{}:q,$=t.extraTokenParams,B=void 0===$?{}:$,H=t.extraHeaders,W=void 0===H?{}:H;if(j(this,e),this.authority=r,n?this.metadataUrl=n:(this.metadataUrl=r,r&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=i,this.metadataSeed=s,this.signingKeys=o,this.client_id=a,this.client_secret=u,this.response_type=l,this.scope=f,this.redirect_uri=h,this.post_logout_redirect_uri=d,this.client_authentication=y,this.prompt=v,this.display=m,this.max_age=_,this.ui_locales=b,this.acr_values=w,this.resource=k,this.response_mode=S,this.filterProtocolClaims=null==E||E,this.loadUserInfo=!!O,this.staleStateAgeInSeconds=C,this.mergeClaimsStrategy=P,this.disablePKCE=!!A,this.revokeTokenAdditionalContentTypes=U,this.fetchRequestCredentials=M||"same-origin",L)this.stateStore=L;else{var z="undefined"!=typeof window?window.localStorage:new fe;this.stateStore=new ge({store:z})}this.refreshTokenAllowedScope=D,this.extraQueryParams=F,this.extraTokenParams=B,this.extraHeaders=W})),ve=function(){return U((function e(t,r){var n=this;j(this,e),this._settings=t,this._metadataService=r,this._logger=new Z("UserInfoService"),this._getClaimsFromJwt=function(){var e=N(R().mark((function e(t){var r,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n._logger.create("_getClaimsFromJwt"),e.prev=1,i=ie.decode(t),r.debug("JWT decoding successful"),e.abrupt("return",i);case 7:throw e.prev=7,e.t0=e.catch(1),r.error("Error parsing JWT response"),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this._jsonService=new he(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}),[{key:"getClaims",value:(e=N(R().mark((function e(t){var r,n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("getClaims"),t||this._logger.throw(new Error("No token passed")),e.next=4,this._metadataService.getUserInfoEndpoint();case 4:return n=e.sent,r.debug("got userinfo url",n),e.next=8,this._jsonService.getJson(n,{token:t,credentials:this._settings.fetchRequestCredentials});case 8:return i=e.sent,r.debug("got claims",i),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e}(),me=function(){return U((function e(t,r){j(this,e),this._settings=t,this._metadataService=r,this._logger=new Z("TokenClient"),this._jsonService=new he(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}),[{key:"exchangeCode",value:(n=N(R().mark((function e(t){var r,n,o,s,a,u,c,l,p,f,h,d,g,y,v,_,b,w,k;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.grant_type,n=void 0===r?"authorization_code":r,o=t.redirect_uri,s=void 0===o?this._settings.redirect_uri:o,a=t.client_id,u=void 0===a?this._settings.client_id:a,c=t.client_secret,l=void 0===c?this._settings.client_secret:c,p=m(t,i),f=this._logger.create("exchangeCode"),u||f.throw(new Error("A client_id is required")),s||f.throw(new Error("A redirect_uri is required")),p.code||f.throw(new Error("A code is required")),h=new URLSearchParams({grant_type:n,redirect_uri:s}),d=0,g=Object.entries(p);d<g.length;d++)y=T(g[d],2),v=y[0],null!=(_=y[1])&&h.set(v,_);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?10:"client_secret_post"===e.t0?15:18;break;case 10:if(l){e.next=13;break}throw f.throw(new Error("A client_secret is required")),null;case 13:return b=te.generateBasicAuth(u,l),e.abrupt("break",18);case 15:return h.append("client_id",u),l&&h.append("client_secret",l),e.abrupt("break",18);case 18:return e.next=20,this._metadataService.getTokenEndpoint(!1);case 20:return w=e.sent,f.debug("got token endpoint"),e.next=24,this._jsonService.postForm(w,{body:h,basicAuth:b,initCredentials:this._settings.fetchRequestCredentials});case 24:return k=e.sent,f.debug("got response"),e.abrupt("return",k);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"exchangeCredentials",value:(r=N(R().mark((function e(t){var r,n,i,s,a,u,c,l,p,f,h,d,g,y,v,_,b,w,k;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.grant_type,n=void 0===r?"password":r,i=t.client_id,s=void 0===i?this._settings.client_id:i,a=t.client_secret,u=void 0===a?this._settings.client_secret:a,c=t.scope,l=void 0===c?this._settings.scope:c,p=m(t,o),f=this._logger.create("exchangeCredentials"),s||f.throw(new Error("A client_id is required")),h=new URLSearchParams({grant_type:n,scope:l}),d=0,g=Object.entries(p);d<g.length;d++)y=T(g[d],2),v=y[0],null!=(_=y[1])&&h.set(v,_);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?8:"client_secret_post"===e.t0?13:16;break;case 8:if(u){e.next=11;break}throw f.throw(new Error("A client_secret is required")),null;case 11:return b=te.generateBasicAuth(s,u),e.abrupt("break",16);case 13:return h.append("client_id",s),u&&h.append("client_secret",u),e.abrupt("break",16);case 16:return e.next=18,this._metadataService.getTokenEndpoint(!1);case 18:return w=e.sent,f.debug("got token endpoint"),e.next=22,this._jsonService.postForm(w,{body:h,basicAuth:b,initCredentials:this._settings.fetchRequestCredentials});case 22:return k=e.sent,f.debug("got response"),e.abrupt("return",k);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"exchangeRefreshToken",value:(t=N(R().mark((function e(t){var r,n,i,o,a,u,c,l,p,f,h,d,g,y,v,_;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.grant_type,n=void 0===r?"refresh_token":r,i=t.client_id,o=void 0===i?this._settings.client_id:i,a=t.client_secret,u=void 0===a?this._settings.client_secret:a,c=t.timeoutInSeconds,l=m(t,s),p=this._logger.create("exchangeRefreshToken"),o||p.throw(new Error("A client_id is required")),l.refresh_token||p.throw(new Error("A refresh_token is required")),f=new URLSearchParams({grant_type:n}),h=R().mark((function e(){var t,r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=T(g[d],2),r=t[0],n=t[1],Array.isArray(n)?n.forEach((function(e){return f.append(r,e)})):null!=n&&f.set(r,n);case 2:case"end":return e.stop()}}),e)})),d=0,g=Object.entries(l);case 7:if(!(d<g.length)){e.next=12;break}return e.delegateYield(h(),"t0",9);case 9:d++,e.next=7;break;case 12:e.t1=this._settings.client_authentication,e.next="client_secret_basic"===e.t1?15:"client_secret_post"===e.t1?20:23;break;case 15:if(u){e.next=18;break}throw p.throw(new Error("A client_secret is required")),null;case 18:return y=te.generateBasicAuth(o,u),e.abrupt("break",23);case 20:return f.append("client_id",o),u&&f.append("client_secret",u),e.abrupt("break",23);case 23:return e.next=25,this._metadataService.getTokenEndpoint(!1);case 25:return v=e.sent,p.debug("got token endpoint"),e.next=29,this._jsonService.postForm(v,{body:f,basicAuth:y,timeoutInSeconds:c,initCredentials:this._settings.fetchRequestCredentials});case 29:return _=e.sent,p.debug("got response"),e.abrupt("return",_);case 32:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"revoke",value:(e=N(R().mark((function e(t){var r,n,i,o,s,a,u,c,l;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("revoke"),t.token||n.throw(new Error("A token is required")),e.next=4,this._metadataService.getRevocationEndpoint(!1);case 4:for(i=e.sent,n.debug("got revocation endpoint, revoking ".concat(null!=(r=t.token_type_hint)?r:"default token type")),o=new URLSearchParams,s=0,a=Object.entries(t);s<a.length;s++)u=T(a[s],2),c=u[0],null!=(l=u[1])&&o.set(c,l);return o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),e.next=12,this._jsonService.postForm(i,{body:o});case 12:n.debug("got response");case 13:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e,t,r,n}(),_e=function(){return U((function e(t,r,n){j(this,e),this._settings=t,this._metadataService=r,this._claimsService=n,this._logger=new Z("ResponseValidator"),this._userInfoService=new ve(this._settings,this._metadataService),this._tokenClient=new me(this._settings,this._metadataService)}),[{key:"validateSigninResponse",value:(i=N(R().mark((function e(t,r){var n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("validateSigninResponse"),this._processSigninState(t,r),n.debug("state processed"),e.next=5,this._processCode(t,r);case 5:return n.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),n.debug("tokens validated"),e.next=10,this._processClaims(t,null==r?void 0:r.skipUserInfo,t.isOpenId);case 10:n.debug("claims processed");case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"validateCredentialsResponse",value:(n=N(R().mark((function e(t,r){var n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("validateCredentialsResponse"),t.isOpenId&&t.id_token&&this._validateIdTokenAttributes(t),n.debug("tokens validated"),e.next=5,this._processClaims(t,r,t.isOpenId);case 5:n.debug("claims processed");case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"validateRefreshResponse",value:(r=N(R().mark((function e(t,r){var n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("validateRefreshResponse"),t.userState=r.data,null!=t.session_state||(t.session_state=r.session_state),null!=t.scope||(t.scope=r.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,r.id_token),n.debug("ID Token validated")),t.id_token||(t.id_token=r.id_token,t.profile=r.profile),i=t.isOpenId&&!!t.id_token,e.next=9,this._processClaims(t,!1,i);case 9:n.debug("claims processed");case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"validateSignoutResponse",value:function(e,t){var r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new ue(e)}},{key:"_processSigninState",value:function(e,t){var r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,e.url_state=t.url_state,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new ue(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}},{key:"_processClaims",value:(t=N(R().mark((function e(t){var r,n,i,o,s=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]&&s[1],n=!(s.length>2&&void 0!==s[2])||s[2],i=this._logger.create("_processClaims"),t.profile=this._claimsService.filterProtocolClaims(t.profile),!r&&this._settings.loadUserInfo&&t.access_token){e.next=7;break}return i.debug("not loading user info"),e.abrupt("return");case 7:return i.debug("loading user info"),e.next=10,this._userInfoService.getClaims(t.access_token);case 10:o=e.sent,i.debug("user info claims received from user info endpoint"),n&&o.sub!==t.profile.sub&&i.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._claimsService.mergeClaims(t.profile,this._claimsService.filterProtocolClaims(o)),i.debug("user info claims received, updated profile:",t.profile);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_processCode",value:(e=N(R().mark((function e(t,r){var n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._logger.create("_processCode"),!t.code){e.next=9;break}return n.debug("Validating code"),e.next=5,this._tokenClient.exchangeCode(y({client_id:r.client_id,client_secret:r.client_secret,code:t.code,redirect_uri:r.redirect_uri,code_verifier:r.code_verifier},r.extraTokenParams));case 5:i=e.sent,Object.assign(t,i),e.next=10;break;case 9:n.debug("No code to process");case 10:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})},{key:"_validateIdTokenAttributes",value:function(e,t){var r,n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");var i=ie.decode(null!=(r=e.id_token)?r:"");if(i.sub||n.throw(new Error("ID Token is missing a subject claim")),t){var o=ie.decode(t);i.sub!==o.sub&&n.throw(new Error("sub in id_token does not match current sub")),i.auth_time&&i.auth_time!==o.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),i.azp&&i.azp!==o.azp&&n.throw(new Error("azp in id_token does not match original azp")),!i.azp&&o.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=i}}]);var e,t,r,n,i}(),be=function(){function e(t){j(this,e),this.id=t.id||te.generateUUIDv4(),this.data=t.data,t.created&&t.created>0?this.created=t.created:this.created=se.getEpochTime(),this.request_type=t.request_type,this.url_state=t.url_state}return U(e,[{key:"toStorageString",value:function(){return new Z("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}}],[{key:"fromStorageString",value:function(t){return Z.createStatic("State","fromStorageString"),Promise.resolve(new e(JSON.parse(t)))}},{key:"clearStaleState",value:(t=N(R().mark((function t(r,n){var i,o,s,a,u,c,l,p;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Z.createStatic("State","clearStaleState"),o=se.getEpochTime()-n,t.next=4,r.getAllKeys();case 4:s=t.sent,i.debug("got keys",s),a=0;case 7:if(!(a<s.length)){t.next=34;break}return u=s[a],t.next=11,r.get(u);case 11:if(c=t.sent,l=!1,!c){t.next=28;break}return t.prev=14,t.next=17,e.fromStorageString(c);case 17:p=t.sent,i.debug("got item from key:",u,p.created),p.created<=o&&(l=!0),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(14),i.error("Error parsing state for key:",u,t.t0),l=!0;case 26:t.next=30;break;case 28:i.debug("no item in storage for key:",u),l=!0;case 30:l&&(i.debug("removed item for key:",u),r.remove(u));case 31:a++,t.next=7;break;case 34:case"end":return t.stop()}}),t,null,[[14,22]])}))),function(e,r){return t.apply(this,arguments)})}]);var t}(),we=function(e){function t(e){var r;return j(this,t),(r=w(this,t,[e])).code_verifier=e.code_verifier,r.code_challenge=e.code_challenge,r.authority=e.authority,r.client_id=e.client_id,r.redirect_uri=e.redirect_uri,r.scope=e.scope,r.client_secret=e.client_secret,r.extraTokenParams=e.extraTokenParams,r.response_mode=e.response_mode,r.skipUserInfo=e.skipUserInfo,r}return S(t,e),U(t,[{key:"toStorageString",value:function(){return new Z("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}}],[{key:"create",value:(r=N(R().mark((function e(r){var n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=!0===r.code_verifier?te.generateCodeVerifier():r.code_verifier||void 0)){e.next=7;break}return e.next=4,te.generateCodeChallenge(n);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=void 0;case 8:return i=e.t0,e.abrupt("return",new t(y(y({},r),{},{code_verifier:n,code_challenge:i})));case 10:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"fromStorageString",value:function(e){Z.createStatic("SigninState","fromStorageString");var r=JSON.parse(e);return t.create(r)}}]);var r}(be),ke=function(){function e(t){j(this,e),this.url=t.url,this.state=t.state}return U(e,null,[{key:"create",value:(t=N(R().mark((function t(r){var n,i,o,s,u,c,l,p,f,h,d,g,v,_,b,w,k,S,x,E,I,O,C,P,N,A;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.url,i=r.authority,o=r.client_id,s=r.redirect_uri,u=r.response_type,c=r.scope,l=r.state_data,p=r.response_mode,f=r.request_type,h=r.client_secret,d=r.nonce,g=r.url_state,v=r.resource,_=r.skipUserInfo,b=r.extraQueryParams,w=r.extraTokenParams,k=r.disablePKCE,S=m(r,a),n){t.next=4;break}throw this._logger.error("create: No url passed"),new Error("url");case 4:if(o){t.next=7;break}throw this._logger.error("create: No client_id passed"),new Error("client_id");case 7:if(s){t.next=10;break}throw this._logger.error("create: No redirect_uri passed"),new Error("redirect_uri");case 10:if(u){t.next=13;break}throw this._logger.error("create: No response_type passed"),new Error("response_type");case 13:if(c){t.next=16;break}throw this._logger.error("create: No scope passed"),new Error("scope");case 16:if(i){t.next=19;break}throw this._logger.error("create: No authority passed"),new Error("authority");case 19:return t.next=21,we.create({data:l,request_type:f,url_state:g,code_verifier:!k,client_id:o,authority:i,redirect_uri:s,response_mode:p,client_secret:h,scope:c,extraTokenParams:w,skipUserInfo:_});case 21:for(x=t.sent,(E=new URL(n)).searchParams.append("client_id",o),E.searchParams.append("redirect_uri",s),E.searchParams.append("response_type",u),E.searchParams.append("scope",c),d&&E.searchParams.append("nonce",d),I=x.id,g&&(I="".concat(I).concat(";").concat(g)),E.searchParams.append("state",I),x.code_challenge&&(E.searchParams.append("code_challenge",x.code_challenge),E.searchParams.append("code_challenge_method","S256")),v&&(Array.isArray(v)?v:[v]).forEach((function(e){return E.searchParams.append("resource",e)})),O=0,C=Object.entries(y(y({response_mode:p},S),b));O<C.length;O++)P=T(C[O],2),N=P[0],null!=(A=P[1])&&E.searchParams.append(N,A.toString());return t.abrupt("return",new e({url:E.href,state:x}));case 35:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})}]);var t}();ke._logger=new Z("SigninRequest");var Se=ke,xe=function(){return U((function e(t){if(j(this,e),this.access_token="",this.token_type="",this.profile={},this.state=t.get("state"),this.session_state=t.get("session_state"),this.state){var r=decodeURIComponent(this.state).split(";");this.state=r[0],r.length>1&&(this.url_state=r.slice(1).join(";"))}this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri"),this.code=t.get("code")}),[{key:"expires_in",get:function(){if(void 0!==this.expires_at)return this.expires_at-se.getEpochTime()},set:function(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+se.getEpochTime())}},{key:"isOpenId",get:function(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}}])}(),Ee=U((function e(t){var r=t.url,n=t.state_data,i=t.id_token_hint,o=t.post_logout_redirect_uri,s=t.extraQueryParams,a=t.request_type,u=t.client_id;if(j(this,e),this._logger=new Z("SignoutRequest"),!r)throw this._logger.error("ctor: No url passed"),new Error("url");var c=new URL(r);i&&c.searchParams.append("id_token_hint",i),u&&c.searchParams.append("client_id",u),o&&(c.searchParams.append("post_logout_redirect_uri",o),n&&(this.state=new be({data:n,request_type:a}),c.searchParams.append("state",this.state.id)));for(var l=0,p=Object.entries(y({},s));l<p.length;l++){var f=T(p[l],2),h=f[0],d=f[1];null!=d&&c.searchParams.append(h,d.toString())}this.url=c.href})),Ie=U((function e(t){j(this,e),this.state=t.get("state"),this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri")})),Oe=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],Te=["sub","iss","aud","exp","iat"],Ce=function(){return U((function e(t){j(this,e),this._settings=t,this._logger=new Z("ClaimsService")}),[{key:"filterProtocolClaims",value:function(e){var t=y({},e);if(this._settings.filterProtocolClaims){var r,n=D(Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:Oe);try{for(n.s();!(r=n.n()).done;){var i=r.value;Te.includes(i)||delete t[i]}}catch(e){n.e(e)}finally{n.f()}}return t}},{key:"mergeClaims",value:function(e,t){for(var r=y({},e),n=0,i=Object.entries(t);n<i.length;n++){var o=T(i[n],2),s=o[0],a=o[1];if(r[s]!==a)if(Array.isArray(r[s])||Array.isArray(a))if("replace"==this._settings.mergeClaimsStrategy.array)r[s]=a;else{var u,c=Array.isArray(r[s])?r[s]:[r[s]],l=D(Array.isArray(a)?a:[a]);try{for(l.s();!(u=l.n()).done;){var p=u.value;c.includes(p)||c.push(p)}}catch(e){l.e(e)}finally{l.f()}r[s]=c}else"object"===$(r[s])&&"object"===$(a)?r[s]=this.mergeClaims(r[s],a):r[s]=a}return r}}])}(),Re=function(){return U((function e(t,r){j(this,e),this._logger=new Z("OidcClient"),this.settings=t instanceof ye?t:new ye(t),this.metadataService=null!=r?r:new de(this.settings),this._claimsService=new Ce(this.settings),this._validator=new _e(this.settings,this.metadataService,this._claimsService),this._tokenClient=new me(this.settings,this.metadataService)}),[{key:"createSigninRequest",value:(u=N(R().mark((function e(t){var r,n,i,o,s,a,u,c,l,p,f,h,d,g,y,v,m,_,b,w,k,S,x,E,I,O,T,C,P,N,A,j,L,U,M,D,q;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,n=t.request,i=t.request_uri,o=t.request_type,s=t.id_token_hint,a=t.login_hint,u=t.skipUserInfo,c=t.nonce,l=t.url_state,p=t.response_type,f=void 0===p?this.settings.response_type:p,h=t.scope,d=void 0===h?this.settings.scope:h,g=t.redirect_uri,y=void 0===g?this.settings.redirect_uri:g,v=t.prompt,m=void 0===v?this.settings.prompt:v,_=t.display,b=void 0===_?this.settings.display:_,w=t.max_age,k=void 0===w?this.settings.max_age:w,S=t.ui_locales,x=void 0===S?this.settings.ui_locales:S,E=t.acr_values,I=void 0===E?this.settings.acr_values:E,O=t.resource,T=void 0===O?this.settings.resource:O,C=t.response_mode,P=void 0===C?this.settings.response_mode:C,N=t.extraQueryParams,A=void 0===N?this.settings.extraQueryParams:N,j=t.extraTokenParams,L=void 0===j?this.settings.extraTokenParams:j,U=this._logger.create("createSigninRequest"),"code"===f){e.next=4;break}throw new Error("Only the Authorization Code flow (with PKCE) is supported");case 4:return e.next=6,this.metadataService.getAuthorizationEndpoint();case 6:return M=e.sent,U.debug("Received authorization endpoint",M),e.next=10,Se.create({url:M,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:y,response_type:f,scope:d,state_data:r,url_state:l,prompt:m,display:b,max_age:k,ui_locales:x,id_token_hint:s,login_hint:a,acr_values:I,resource:T,request:n,request_uri:i,extraQueryParams:A,extraTokenParams:L,request_type:o,response_mode:P,client_secret:this.settings.client_secret,skipUserInfo:u,nonce:c,disablePKCE:this.settings.disablePKCE});case 10:return D=e.sent,e.next=13,this.clearStaleState();case 13:return q=D.state,e.next=16,this.settings.stateStore.set(q.id,q.toStorageString());case 16:return e.abrupt("return",D);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"readSigninResponseState",value:(a=N(R().mark((function e(t){var r,n,i,o,s,a=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]&&a[1],n=this._logger.create("readSigninResponseState"),(i=new xe(ae.readParams(t,this.settings.response_mode))).state){e.next=6;break}throw n.throw(new Error("No state in response")),null;case 6:return e.next=8,this.settings.stateStore[r?"remove":"get"](i.state);case 8:if(o=e.sent){e.next=12;break}throw n.throw(new Error("No matching state found in storage")),null;case 12:return e.next=14,we.fromStorageString(o);case 14:return s=e.sent,e.abrupt("return",{state:s,response:i});case 16:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"processSigninResponse",value:(s=N(R().mark((function e(t){var r,n,i,o;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("processSigninResponse"),e.next=3,this.readSigninResponseState(t,!0);case 3:return n=e.sent,i=n.state,o=n.response,r.debug("received state from storage; validating response"),e.next=9,this._validator.validateSigninResponse(o,i);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"processResourceOwnerPasswordCredentials",value:(o=N(R().mark((function e(t){var r,n,i,o,s,a,u,c;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,n=t.password,i=t.skipUserInfo,o=void 0!==i&&i,s=t.extraTokenParams,a=void 0===s?{}:s,e.next=3,this._tokenClient.exchangeCredentials(y({username:r,password:n},a));case 3:return u=e.sent,c=new xe(new URLSearchParams),Object.assign(c,u),e.next=8,this._validator.validateCredentialsResponse(c,o);case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"useRefreshToken",value:(i=N(R().mark((function e(t){var r,n,i,o,s,a,u,c,l,p,f,h;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,n=t.redirect_uri,i=t.resource,o=t.timeoutInSeconds,s=t.extraTokenParams,u=this._logger.create("useRefreshToken"),void 0===this.settings.refreshTokenAllowedScope?c=r.scope:(l=this.settings.refreshTokenAllowedScope.split(" "),p=(null==(a=r.scope)?void 0:a.split(" "))||[],c=p.filter((function(e){return l.includes(e)})).join(" ")),e.next=5,this._tokenClient.exchangeRefreshToken(y({refresh_token:r.refresh_token,scope:c,redirect_uri:n,resource:i,timeoutInSeconds:o},s));case 5:return f=e.sent,h=new xe(new URLSearchParams),Object.assign(h,f),u.debug("validating response",h),e.next=11,this._validator.validateRefreshResponse(h,y(y({},r),{},{scope:c}));case 11:return e.abrupt("return",h);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createSignoutRequest",value:(n=N(R().mark((function e(){var t,r,n,i,o,s,a,u,c,l,p,f,h,d=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},r=t.state,n=t.id_token_hint,i=t.client_id,o=t.request_type,s=t.post_logout_redirect_uri,a=void 0===s?this.settings.post_logout_redirect_uri:s,u=t.extraQueryParams,c=void 0===u?this.settings.extraQueryParams:u,l=this._logger.create("createSignoutRequest"),e.next=4,this.metadataService.getEndSessionEndpoint();case 4:if(p=e.sent){e.next=8;break}throw l.throw(new Error("No end session endpoint")),null;case 8:return l.debug("Received end session endpoint",p),i||!a||n||(i=this.settings.client_id),f=new Ee({url:p,id_token_hint:n,client_id:i,post_logout_redirect_uri:a,state_data:r,extraQueryParams:c,request_type:o}),e.next=13,this.clearStaleState();case 13:if(!(h=f.state)){e.next=18;break}return l.debug("Signout request has state to persist"),e.next=18,this.settings.stateStore.set(h.id,h.toStorageString());case 18:return e.abrupt("return",f);case 19:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"readSignoutResponseState",value:(r=N(R().mark((function e(t){var r,n,i,o,s,a=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]&&a[1],n=this._logger.create("readSignoutResponseState"),(i=new Ie(ae.readParams(t,this.settings.response_mode))).state){e.next=9;break}if(n.debug("No state in response"),!i.error){e.next=8;break}throw n.warn("Response was error:",i.error),new ue(i);case 8:return e.abrupt("return",{state:void 0,response:i});case 9:return e.next=11,this.settings.stateStore[r?"remove":"get"](i.state);case 11:if(o=e.sent){e.next=15;break}throw n.throw(new Error("No matching state found in storage")),null;case 15:return e.next=17,be.fromStorageString(o);case 17:return s=e.sent,e.abrupt("return",{state:s,response:i});case 19:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"processSignoutResponse",value:(t=N(R().mark((function e(t){var r,n,i,o;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("processSignoutResponse"),e.next=3,this.readSignoutResponseState(t,!0);case 3:return n=e.sent,i=n.state,o=n.response,i?(r.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(o,i)):r.debug("No state from storage; skipping response validation"),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clearStaleState",value:function(){return this._logger.create("clearStaleState"),be.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}},{key:"revokeToken",value:(e=N(R().mark((function e(t,r){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("revokeToken"),e.next=3,this._tokenClient.revoke({token:t,token_type_hint:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})}]);var e,t,r,n,i,o,s,a,u}(),Pe=function(){return U((function e(t){var r=this;j(this,e),this._userManager=t,this._logger=new Z("SessionMonitor"),this._start=function(){var e=N(R().mark((function e(t){var n,i,o,s,a,u,c;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.session_state){e.next=3;break}return e.abrupt("return");case 3:if(i=r._logger.create("_start"),t.profile?(r._sub=t.profile.sub,i.debug("session_state",n,", sub",r._sub)):(r._sub=void 0,i.debug("session_state",n,", anonymous user")),!r._checkSessionIFrame){e.next=8;break}return r._checkSessionIFrame.start(n),e.abrupt("return");case 8:return e.prev=8,e.next=11,r._userManager.metadataService.getCheckSessionIframe();case 11:if(!(o=e.sent)){e.next=24;break}return i.debug("initializing check session iframe"),s=r._userManager.settings.client_id,a=r._userManager.settings.checkSessionIntervalInSeconds,u=r._userManager.settings.stopCheckSessionOnError,c=new pe(r._callback,s,o,a,u),e.next=20,c.load();case 20:r._checkSessionIFrame=c,c.start(n),e.next=25;break;case 24:i.warn("no check session iframe found in the metadata");case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(8),i.error("Error from getCheckSessionIframe:",e.t0 instanceof Error?e.t0.message:e.t0);case 30:case"end":return e.stop()}}),e,null,[[8,27]])})));return function(t){return e.apply(this,arguments)}}(),this._stop=function(){var e=r._logger.create("_stop");if(r._sub=void 0,r._checkSessionIFrame&&r._checkSessionIFrame.stop(),r._userManager.settings.monitorAnonymousSession)var t=setInterval(N(R().mark((function n(){var i,o;return R().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearInterval(t),n.prev=1,n.next=4,r._userManager.querySessionStatus();case 4:(i=n.sent)&&(o={session_state:i.session_state,profile:i.sub?{sub:i.sub}:null},r._start(o)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),e.error("error from querySessionStatus",n.t0 instanceof Error?n.t0.message:n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])}))),1e3)},this._callback=N(R().mark((function e(){var t,n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._logger.create("_callback"),e.prev=1,e.next=4,r._userManager.querySessionStatus();case 4:if(n=e.sent,i=!0,!n||!r._checkSessionIFrame){e.next=18;break}if(n.sub!==r._sub){e.next=15;break}return i=!1,r._checkSessionIFrame.start(n.session_state),t.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",n.session_state),e.next=13,r._userManager.events._raiseUserSessionChanged();case 13:e.next=16;break;case 15:t.debug("different subject signed into OP",n.sub);case 16:e.next=19;break;case 18:t.debug("subject no longer signed into OP");case 19:if(!i){e.next=29;break}if(!r._sub){e.next=25;break}return e.next=23,r._userManager.events._raiseUserSignedOut();case 23:e.next=27;break;case 25:return e.next=27,r._userManager.events._raiseUserSignedIn();case 27:e.next=30;break;case 29:t.debug("no change in session detected, no event to raise");case 30:e.next=38;break;case 32:if(e.prev=32,e.t0=e.catch(1),!r._sub){e.next=38;break}return t.debug("Error calling queryCurrentSigninSession; raising signed out event",e.t0),e.next=38,r._userManager.events._raiseUserSignedOut();case 38:case"end":return e.stop()}}),e,null,[[1,32]])}))),t||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((function(e){r._logger.error(e)}))}),[{key:"_init",value:(e=N(R().mark((function e(){var t,r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("_init"),e.next=3,this._userManager.getUser();case 3:if(!(t=e.sent)){e.next=8;break}this._start(t),e.next=13;break;case 8:if(!this._userManager.settings.monitorAnonymousSession){e.next=13;break}return e.next=11,this._userManager.querySessionStatus();case 11:(r=e.sent)&&(n={session_state:r.session_state,profile:r.sub?{sub:r.sub}:null},this._start(n));case 13:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e}(),Ne=function(){function e(t){var r;j(this,e),this.id_token=t.id_token,this.session_state=null!=(r=t.session_state)?r:null,this.access_token=t.access_token,this.refresh_token=t.refresh_token,this.token_type=t.token_type,this.scope=t.scope,this.profile=t.profile,this.expires_at=t.expires_at,this.state=t.userState,this.url_state=t.url_state}return U(e,[{key:"expires_in",get:function(){if(void 0!==this.expires_at)return this.expires_at-se.getEpochTime()},set:function(e){void 0!==e&&(this.expires_at=Math.floor(e)+se.getEpochTime())}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}},{key:"toStorageString",value:function(){return new Z("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}}],[{key:"fromStorageString",value:function(t){return Z.createStatic("User","fromStorageString"),new e(JSON.parse(t))}}])}(),Ae=function(){return U((function e(){j(this,e),this._abort=new re("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}),[{key:"navigate",value:(e=N(R().mark((function e(t){var r,n,i,o,s=this;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._logger.create("navigate"),this._window){e.next=3;break}throw new Error("Attempted to navigate on a disposed window");case 3:return r.debug("setting URL in window"),this._window.location.replace(t.url),e.next=7,new Promise((function(e,n){var i=function(i){var o,a=i.data,u=null!=(o=t.scriptOrigin)?o:window.location.origin;if(i.origin===u&&"oidc-client"===(null==a?void 0:a.source)){try{var c=ae.readParams(a.url,t.response_mode).get("state");if(c||r.warn("no state found in response url"),i.source!==s._window&&c!==t.state)return}catch(e){s._dispose(),n(new Error("Invalid response from window"))}e(a)}};window.addEventListener("message",i,!1),s._disposeHandlers.add((function(){return window.removeEventListener("message",i,!1)})),s._disposeHandlers.add(s._abort.addHandler((function(e){s._dispose(),n(e)})))}));case 7:return n=e.sent,i=n.url,o=n.keepOpen,r.debug("got response from window"),this._dispose(),o||this.close(),e.abrupt("return",{url:i});case 14:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"_dispose",value:function(){this._logger.create("_dispose");var e,t=D(this._disposeHandlers);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(e){t.e(e)}finally{t.f()}this._disposeHandlers.clear()}}],[{key:"_notifyParent",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.location.origin;e.postMessage({source:"oidc-client",url:t,keepOpen:r},n)}}]);var e}(),je={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},Le=function(e){function t(e){var r;j(this,t);var n=e.popup_redirect_uri,i=void 0===n?e.redirect_uri:n,o=e.popup_post_logout_redirect_uri,s=void 0===o?e.post_logout_redirect_uri:o,a=e.popupWindowFeatures,u=void 0===a?je:a,c=e.popupWindowTarget,l=void 0===c?"_blank":c,p=e.redirectMethod,f=void 0===p?"assign":p,h=e.redirectTarget,d=void 0===h?"self":h,g=e.iframeNotifyParentOrigin,y=void 0===g?e.iframeNotifyParentOrigin:g,v=e.iframeScriptOrigin,m=void 0===v?e.iframeScriptOrigin:v,_=e.silent_redirect_uri,b=void 0===_?e.redirect_uri:_,k=e.silentRequestTimeoutInSeconds,S=void 0===k?10:k,x=e.automaticSilentRenew,E=void 0===x||x,I=e.validateSubOnSilentRenew,O=void 0===I||I,T=e.includeIdTokenInSilentRenew,C=void 0!==T&&T,R=e.monitorSession,P=void 0!==R&&R,N=e.monitorAnonymousSession,A=void 0!==N&&N,L=e.checkSessionIntervalInSeconds,U=void 0===L?2:L,M=e.query_status_response_type,D=void 0===M?"code":M,q=e.stopCheckSessionOnError,F=void 0===q||q,$=e.revokeTokenTypes,B=void 0===$?["access_token","refresh_token"]:$,H=e.revokeTokensOnSignout,W=void 0!==H&&H,z=e.includeIdTokenInSilentSignout,G=void 0!==z&&z,K=e.accessTokenExpiringNotificationTimeInSeconds,J=void 0===K?60:K,X=e.userStore;if((r=w(this,t,[e])).popup_redirect_uri=i,r.popup_post_logout_redirect_uri=s,r.popupWindowFeatures=u,r.popupWindowTarget=l,r.redirectMethod=f,r.redirectTarget=d,r.iframeNotifyParentOrigin=y,r.iframeScriptOrigin=m,r.silent_redirect_uri=b,r.silentRequestTimeoutInSeconds=S,r.automaticSilentRenew=E,r.validateSubOnSilentRenew=O,r.includeIdTokenInSilentRenew=C,r.monitorSession=P,r.monitorAnonymousSession=A,r.checkSessionIntervalInSeconds=U,r.stopCheckSessionOnError=F,r.query_status_response_type=D,r.revokeTokenTypes=B,r.revokeTokensOnSignout=W,r.includeIdTokenInSilentSignout=G,r.accessTokenExpiringNotificationTimeInSeconds=J,X)r.userStore=X;else{var V="undefined"!=typeof window?window.sessionStorage:new fe;r.userStore=new ge({store:V})}return r}return S(t,e),U(t)}(ye),Ue=function(e){function t(e){var r,n=e.silentRequestTimeoutInSeconds,i=void 0===n?10:n;return j(this,t),(r=w(this,t))._logger=new Z("IFrameWindow"),r._timeoutInSeconds=i,r._frame=t.createHiddenIframe(),r._window=r._frame.contentWindow,r}return S(t,e),U(t,[{key:"navigate",value:(r=N(R().mark((function e(r){var n,i=this;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds),n=setTimeout((function(){i._abort.raise(new ce("IFrame timed out without a response"))}),1e3*this._timeoutInSeconds),this._disposeHandlers.add((function(){return clearTimeout(n)})),e.next=5,E(O(t.prototype),"navigate",this).call(this,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"close",value:function(){var e,t=this;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(function(e){var r,n=e.target;null==(r=n.parentNode)||r.removeChild(n),t._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}}],[{key:"createHiddenIframe",value:function(){var e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}},{key:"notifyParent",value:function(e,r){return E(O(t),"_notifyParent",this).call(this,window.parent,e,!1,r)}}]);var r}(Ae),Me=function(){return U((function e(t){j(this,e),this._settings=t,this._logger=new Z("IFrameNavigator")}),[{key:"prepare",value:(t=N(R().mark((function e(t){var r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.silentRequestTimeoutInSeconds,n=void 0===r?this._settings.silentRequestTimeoutInSeconds:r,e.abrupt("return",new Ue({silentRequestTimeoutInSeconds:n}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"callback",value:(e=N(R().mark((function e(t){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._logger.create("callback"),Ue.notifyParent(t,this._settings.iframeNotifyParentOrigin);case 2:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e,t}(),De=function(e){function t(e){var r,n=e.popupWindowTarget,i=void 0===n?"_blank":n,o=e.popupWindowFeatures,s=void 0===o?{}:o;j(this,t),(r=w(this,t))._logger=new Z("PopupWindow");var a=oe.center(y(y({},je),s));return r._window=window.open(void 0,i,oe.serialize(a)),s.closePopupWindowAfterInSeconds&&s.closePopupWindowAfterInSeconds>0&&setTimeout((function(){r._window&&"boolean"==typeof r._window.closed&&!r._window.closed?r.close():r._abort.raise(new Error("Popup blocked by user"))}),1e3*s.closePopupWindowAfterInSeconds),r}return S(t,e),U(t,[{key:"navigate",value:(r=N(R().mark((function e(r){var n,i,o=this;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this._window)||n.focus(),i=setInterval((function(){o._window&&!o._window.closed||o._abort.raise(new Error("Popup closed by user"))}),500),this._disposeHandlers.add((function(){return clearInterval(i)})),e.next=5,E(O(t.prototype),"navigate",this).call(this,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"close",value:function(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}}],[{key:"notifyOpener",value:function(e,r){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return E(O(t),"_notifyParent",this).call(this,window.opener,e,r)}}]);var r}(Ae),qe=function(){return U((function e(t){j(this,e),this._settings=t,this._logger=new Z("PopupNavigator")}),[{key:"prepare",value:(t=N(R().mark((function e(t){var r,n,i,o;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.popupWindowFeatures,n=void 0===r?this._settings.popupWindowFeatures:r,i=t.popupWindowTarget,o=void 0===i?this._settings.popupWindowTarget:i,e.abrupt("return",new De({popupWindowFeatures:n,popupWindowTarget:o}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"callback",value:(e=N(R().mark((function e(t,r){var n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.keepOpen,i=void 0!==n&&n,this._logger.create("callback"),De.notifyOpener(t,i);case 3:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})}]);var e,t}(),Fe=function(){return U((function e(t){j(this,e),this._settings=t,this._logger=new Z("RedirectNavigator")}),[{key:"prepare",value:(t=N(R().mark((function e(t){var r,n,i,o,s,a,u,c,l=this;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.redirectMethod,n=void 0===r?this._settings.redirectMethod:r,i=t.redirectTarget,o=void 0===i?this._settings.redirectTarget:i,this._logger.create("prepare"),a=window.self,"top"===o&&(a=null!=(s=window.top)?s:window.self),u=a.location[n].bind(a.location),e.abrupt("return",{navigate:function(){var e=N(R().mark((function e(t){var r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l._logger.create("navigate"),r=new Promise((function(e,t){c=t})),u(t.url),e.next=5,r;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),close:function(){l._logger.create("close"),null==c||c(new Error("Redirect aborted")),a.stop()}});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"callback",value:(e=N(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})}]);var e,t}(),$e=function(e){function t(e){var r;return j(this,t),(r=w(this,t,[{expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}]))._logger=new Z("UserManagerEvents"),r._userLoaded=new re("User loaded"),r._userUnloaded=new re("User unloaded"),r._silentRenewError=new re("Silent renew error"),r._userSignedIn=new re("User signed in"),r._userSignedOut=new re("User signed out"),r._userSessionChanged=new re("User session changed"),r}return S(t,e),U(t,[{key:"load",value:(a=N(R().mark((function e(r){var n,i=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(i.length>1&&void 0!==i[1])||i[1],E(O(t.prototype),"load",this).call(this,r),!n){e.next=5;break}return e.next=5,this._userLoaded.raise(r);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"unload",value:(s=N(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(O(t.prototype),"unload",this).call(this),e.next=3,this._userUnloaded.raise();case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"addUserLoaded",value:function(e){return this._userLoaded.addHandler(e)}},{key:"removeUserLoaded",value:function(e){return this._userLoaded.removeHandler(e)}},{key:"addUserUnloaded",value:function(e){return this._userUnloaded.addHandler(e)}},{key:"removeUserUnloaded",value:function(e){return this._userUnloaded.removeHandler(e)}},{key:"addSilentRenewError",value:function(e){return this._silentRenewError.addHandler(e)}},{key:"removeSilentRenewError",value:function(e){return this._silentRenewError.removeHandler(e)}},{key:"_raiseSilentRenewError",value:(o=N(R().mark((function e(t){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._silentRenewError.raise(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"addUserSignedIn",value:function(e){return this._userSignedIn.addHandler(e)}},{key:"removeUserSignedIn",value:function(e){this._userSignedIn.removeHandler(e)}},{key:"_raiseUserSignedIn",value:(i=N(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._userSignedIn.raise();case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"addUserSignedOut",value:function(e){return this._userSignedOut.addHandler(e)}},{key:"removeUserSignedOut",value:function(e){this._userSignedOut.removeHandler(e)}},{key:"_raiseUserSignedOut",value:(n=N(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._userSignedOut.raise();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"addUserSessionChanged",value:function(e){return this._userSessionChanged.addHandler(e)}},{key:"removeUserSessionChanged",value:function(e){this._userSessionChanged.removeHandler(e)}},{key:"_raiseUserSessionChanged",value:(r=N(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._userSessionChanged.raise();case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]);var r,n,i,o,s,a}(le),Be=function(){return U((function e(t){var r=this;j(this,e),this._userManager=t,this._logger=new Z("SilentRenewService"),this._isStarted=!1,this._retryTimer=new se("Retry Silent Renew"),this._tokenExpiring=N(R().mark((function e(){var t;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._logger.create("_tokenExpiring"),e.prev=1,e.next=4,r._userManager.signinSilent();case 4:t.debug("silent token renewal successful"),e.next=16;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof ce)){e.next=13;break}return t.warn("ErrorTimeout from signinSilent:",e.t0,"retry in 5s"),r._retryTimer.init(5),e.abrupt("return");case 13:return t.error("Error from signinSilent:",e.t0),e.next=16,r._userManager.events._raiseSilentRenewError(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,7]])})))}),[{key:"start",value:(e=N(R().mark((function e(){var t;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("start"),this._isStarted){e.next=13;break}return this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring),e.prev=5,e.next=8,this._userManager.getUser();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),t.error("getUser error",e.t0);case 13:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(){return e.apply(this,arguments)})},{key:"stop",value:function(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}]);var e}(),He=U((function e(t){j(this,e),this.refresh_token=t.refresh_token,this.id_token=t.id_token,this.session_state=t.session_state,this.scope=t.scope,this.profile=t.profile,this.data=t.state})),We=function(){return U((function e(t,r,n,i){j(this,e),this._logger=new Z("UserManager"),this.settings=new Le(t),this._client=new Re(t),this._redirectNavigator=null!=r?r:new Fe(this.settings),this._popupNavigator=null!=n?n:new qe(this.settings),this._iframeNavigator=null!=i?i:new Me(this.settings),this._events=new $e(this.settings),this._silentRenewService=new Be(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new Pe(this))}),[{key:"events",get:function(){return this._events}},{key:"metadataService",get:function(){return this._client.metadataService}},{key:"getUser",value:(W=N(R().mark((function e(){var t,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("getUser"),e.next=3,this._loadUser();case 3:if(!(r=e.sent)){e.next=9;break}return t.info("user loaded"),e.next=8,this._events.load(r,!1);case 8:return e.abrupt("return",r);case 9:return t.info("user not found in storage"),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)})},{key:"removeUser",value:(H=N(R().mark((function e(){var t;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("removeUser"),e.next=3,this.storeUser(null);case 3:return t.info("user removed from storage"),e.next=6,this._events.unload();case 6:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)})},{key:"signinRedirect",value:(B=N(R().mark((function e(){var t,r,n,i,o=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},this._logger.create("signinRedirect"),r=t.redirectMethod,n=m(t,u),e.next=5,this._redirectNavigator.prepare({redirectMethod:r});case 5:return i=e.sent,e.next=8,this._signinStart(y({request_type:"si:r"},n),i);case 8:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"signinRedirectCallback",value:($=N(R().mark((function e(){var t,r,n,i=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,r=this._logger.create("signinRedirectCallback"),e.next=4,this._signinEnd(t);case 4:return(n=e.sent).profile&&n.profile.sub?r.info("success, signed in subject",n.profile.sub):r.info("no subject"),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return $.apply(this,arguments)})},{key:"signinResourceOwnerCredentials",value:(F=N(R().mark((function e(t){var r,n,i,o,s,a,u;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,n=t.password,i=t.skipUserInfo,o=void 0!==i&&i,s=this._logger.create("signinResourceOwnerCredential"),e.next=4,this._client.processResourceOwnerPasswordCredentials({username:r,password:n,skipUserInfo:o,extraTokenParams:this.settings.extraTokenParams});case 4:return a=e.sent,s.debug("got signin response"),e.next=8,this._buildUser(a);case 8:return(u=e.sent).profile&&u.profile.sub?s.info("success, signed in subject",u.profile.sub):s.info("no subject"),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"signinPopup",value:(q=N(R().mark((function e(){var t,r,n,i,o,s,a,u,l=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=this._logger.create("signinPopup"),n=t.popupWindowFeatures,i=t.popupWindowTarget,o=m(t,c),(s=this.settings.popup_redirect_uri)||r.throw(new Error("No popup_redirect_uri configured")),e.next=7,this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:i});case 7:return a=e.sent,e.next=10,this._signin(y({request_type:"si:p",redirect_uri:s,display:"popup"},o),a);case 10:return(u=e.sent)&&(u.profile&&u.profile.sub?r.info("success, signed in subject",u.profile.sub):r.info("no subject")),e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)}))),function(){return q.apply(this,arguments)})},{key:"signinPopupCallback",value:(M=N(R().mark((function e(){var t,r,n,i=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,r=i.length>1&&void 0!==i[1]&&i[1],n=this._logger.create("signinPopupCallback"),e.next=5,this._popupNavigator.callback(t,{keepOpen:r});case 5:n.info("success");case 6:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"signinSilent",value:(L=N(R().mark((function e(){var t,r,n,i,o,s,a,u,c,p,f=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},n=this._logger.create("signinSilent"),i=t.silentRequestTimeoutInSeconds,o=m(t,l),e.next=5,this._loadUser();case 5:if(!(null==(s=e.sent)?void 0:s.refresh_token)){e.next=12;break}return n.debug("using refresh token"),a=new He(s),e.next=11,this._useRefreshToken({state:a,redirect_uri:o.redirect_uri,resource:o.resource,extraTokenParams:o.extraTokenParams,timeoutInSeconds:i});case 11:return e.abrupt("return",e.sent);case 12:return(u=this.settings.silent_redirect_uri)||n.throw(new Error("No silent_redirect_uri configured")),s&&this.settings.validateSubOnSilentRenew&&(n.debug("subject prior to silent renew:",s.profile.sub),c=s.profile.sub),e.next=17,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:i});case 17:return p=e.sent,e.next=20,this._signin(y({request_type:"si:s",redirect_uri:u,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==s?void 0:s.id_token:void 0},o),p,c);case 20:return(s=e.sent)&&((null==(r=s.profile)?void 0:r.sub)?n.info("success, signed in subject",s.profile.sub):n.info("no subject")),e.abrupt("return",s);case 23:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"_useRefreshToken",value:(A=N(R().mark((function e(t){var r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.useRefreshToken(y(y({},t),{},{timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}));case 2:return r=e.sent,n=new Ne(y(y({},t.state),r)),e.next=6,this.storeUser(n);case 6:return e.next=8,this._events.load(n);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"signinSilentCallback",value:(P=N(R().mark((function e(){var t,r,n=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:window.location.href,r=this._logger.create("signinSilentCallback"),e.next=4,this._iframeNavigator.callback(t);case 4:r.info("success");case 5:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"signinCallback",value:(C=N(R().mark((function e(){var t,r,n,i=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,e.next=3,this._client.readSigninResponseState(t);case 3:r=e.sent,n=r.state,e.t0=n.request_type,e.next="si:r"===e.t0?8:"si:p"===e.t0?11:"si:s"===e.t0?14:17;break;case 8:return e.next=10,this.signinRedirectCallback(t);case 10:return e.abrupt("return",e.sent);case 11:return e.next=13,this.signinPopupCallback(t);case 13:return e.abrupt("return",e.sent);case 14:return e.next=16,this.signinSilentCallback(t);case 16:return e.abrupt("return",e.sent);case 17:throw new Error("invalid response_type in state");case 18:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"signoutCallback",value:(T=N(R().mark((function e(){var t,r,n,i,o=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:window.location.href,r=o.length>1&&void 0!==o[1]&&o[1],e.next=4,this._client.readSignoutResponseState(t);case 4:if(n=e.sent,i=n.state){e.next=8;break}return e.abrupt("return");case 8:e.t0=i.request_type,e.next="so:r"===e.t0?11:"so:p"===e.t0?14:"so:s"===e.t0?17:20;break;case 11:return e.next=13,this.signoutRedirectCallback(t);case 13:return e.abrupt("break",21);case 14:return e.next=16,this.signoutPopupCallback(t,r);case 16:return e.abrupt("break",21);case 17:return e.next=19,this.signoutSilentCallback(t);case 19:return e.abrupt("break",21);case 20:throw new Error("invalid response_type in state");case 21:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"querySessionStatus",value:(O=N(R().mark((function e(){var t,r,n,i,o,s,a,u,c,l=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=this._logger.create("querySessionStatus"),n=t.silentRequestTimeoutInSeconds,i=m(t,p),(o=this.settings.silent_redirect_uri)||r.throw(new Error("No silent_redirect_uri configured")),e.next=7,this._loadUser();case 7:return s=e.sent,e.next=10,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});case 10:return a=e.sent,e.next=13,this._signinStart(y({request_type:"si:s",redirect_uri:o,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==s?void 0:s.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},i),a);case 13:return u=e.sent,e.prev=14,e.next=17,this._client.processSigninResponse(u.url);case 17:if(c=e.sent,r.debug("got signin response"),!c.session_state||!c.profile.sub){e.next=22;break}return r.info("success for subject",c.profile.sub),e.abrupt("return",{session_state:c.session_state,sub:c.profile.sub});case 22:return r.info("success, user not authenticated"),e.abrupt("return",null);case 26:if(e.prev=26,e.t0=e.catch(14),!(this.settings.monitorAnonymousSession&&e.t0 instanceof ue)){e.next=34;break}e.t1=e.t0.error,e.next="login_required"===e.t1||"consent_required"===e.t1||"interaction_required"===e.t1||"account_selection_required"===e.t1?32:34;break;case 32:return r.info("success for anonymous user"),e.abrupt("return",{session_state:e.t0.session_state});case 34:throw e.t0;case 35:case"end":return e.stop()}}),e,this,[[14,26]])}))),function(){return O.apply(this,arguments)})},{key:"_signin",value:(I=N(R().mark((function e(t,r,n){var i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._signinStart(t,r);case 2:return i=e.sent,e.next=5,this._signinEnd(i.url,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return I.apply(this,arguments)})},{key:"_signinStart",value:(E=N(R().mark((function e(t,r){var n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("_signinStart"),e.prev=1,e.next=4,this._client.createSigninRequest(t);case 4:return i=e.sent,n.debug("got signin request"),e.next=8,r.navigate({url:i.url,state:i.state.id,response_mode:i.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin});case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(1),n.debug("error after preparing navigator, closing navigator window"),r.close(),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(e,t){return E.apply(this,arguments)})},{key:"_signinEnd",value:(x=N(R().mark((function e(t,r){var n,i,o;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("_signinEnd"),e.next=3,this._client.processSigninResponse(t);case 3:return i=e.sent,n.debug("got signin response"),e.next=7,this._buildUser(i,r);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"_buildUser",value:(S=N(R().mark((function e(t,r){var n,i;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._logger.create("_buildUser"),i=new Ne(t),!r){e.next=7;break}if(r===i.profile.sub){e.next=6;break}throw n.debug("current user does not match user returned from signin. sub from signin:",i.profile.sub),new ue(y(y({},t),{},{error:"login_required"}));case 6:n.debug("current user matches user returned from signin");case 7:return e.next=9,this.storeUser(i);case 9:return n.debug("user stored"),e.next=12,this._events.load(i);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"signoutRedirect",value:(k=N(R().mark((function e(){var t,r,n,i,o,s=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=this._logger.create("signoutRedirect"),n=t.redirectMethod,i=m(t,f),e.next=5,this._redirectNavigator.prepare({redirectMethod:n});case 5:return o=e.sent,e.next=8,this._signoutStart(y({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},i),o);case 8:r.info("success");case 9:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"signoutRedirectCallback",value:(w=N(R().mark((function e(){var t,r,n,i=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,r=this._logger.create("signoutRedirectCallback"),e.next=4,this._signoutEnd(t);case 4:return n=e.sent,r.info("success"),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"signoutPopup",value:(b=N(R().mark((function e(){var t,r,n,i,o,s,a,u=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=this._logger.create("signoutPopup"),n=t.popupWindowFeatures,i=t.popupWindowTarget,o=m(t,h),s=this.settings.popup_post_logout_redirect_uri,e.next=6,this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:i});case 6:return a=e.sent,e.next=9,this._signout(y({request_type:"so:p",post_logout_redirect_uri:s,state:null==s?void 0:{}},o),a);case 9:r.info("success");case 10:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"signoutPopupCallback",value:(_=N(R().mark((function e(){var t,r,n,i=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,r=i.length>1&&void 0!==i[1]&&i[1],n=this._logger.create("signoutPopupCallback"),e.next=5,this._popupNavigator.callback(t,{keepOpen:r});case 5:n.info("success");case 6:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"_signout",value:(v=N(R().mark((function e(t,r){var n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._signoutStart(t,r);case 2:return n=e.sent,e.next=5,this._signoutEnd(n.url);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"_signoutStart",value:(g=N(R().mark((function e(){var t,r,n,i,o,s,a,u=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,i=this._logger.create("_signoutStart"),e.prev=3,e.next=6,this._loadUser();case 6:if(o=e.sent,i.debug("loaded current user from storage"),!this.settings.revokeTokensOnSignout){e.next=11;break}return e.next=11,this._revokeInternal(o);case 11:return(s=t.id_token_hint||o&&o.id_token)&&(i.debug("setting id_token_hint in signout request"),t.id_token_hint=s),e.next=15,this.removeUser();case 15:return i.debug("user removed, creating signout request"),e.next=18,this._client.createSignoutRequest(t);case 18:return a=e.sent,i.debug("got signout request"),e.next=22,r.navigate({url:a.url,state:null==(n=a.state)?void 0:n.id,scriptOrigin:this.settings.iframeScriptOrigin});case 22:return e.abrupt("return",e.sent);case 25:throw e.prev=25,e.t0=e.catch(3),i.debug("error after preparing navigator, closing navigator window"),r.close(),e.t0;case 30:case"end":return e.stop()}}),e,this,[[3,25]])}))),function(){return g.apply(this,arguments)})},{key:"_signoutEnd",value:(a=N(R().mark((function e(t){var r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("_signoutEnd"),e.next=3,this._client.processSignoutResponse(t);case 3:return n=e.sent,r.debug("got signout response"),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"signoutSilent",value:(s=N(R().mark((function e(){var t,r,n,i,o,s,a,u,c=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:{},n=this._logger.create("signoutSilent"),i=t.silentRequestTimeoutInSeconds,o=m(t,d),!this.settings.includeIdTokenInSilentSignout){e.next=15;break}return e.next=6,this._loadUser();case 6:if(e.t1=r=e.sent,null!=e.t1){e.next=11;break}e.t2=void 0,e.next=12;break;case 11:e.t2=r.id_token;case 12:e.t0=e.t2,e.next=16;break;case 15:e.t0=void 0;case 16:return s=e.t0,a=this.settings.popup_post_logout_redirect_uri,e.next=20,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:i});case 20:return u=e.sent,e.next=23,this._signout(y({request_type:"so:s",post_logout_redirect_uri:a,id_token_hint:s},o),u);case 23:n.info("success");case 24:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"signoutSilentCallback",value:(o=N(R().mark((function e(){var t,r,n=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:window.location.href,r=this._logger.create("signoutSilentCallback"),e.next=4,this._iframeNavigator.callback(t);case 4:r.info("success");case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"revokeTokens",value:(i=N(R().mark((function e(t){var r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadUser();case 2:return r=e.sent,e.next=5,this._revokeInternal(r,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_revokeInternal",value:(n=N(R().mark((function e(t){var r,n,i,o,s,a,u=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:this.settings.revokeTokenTypes,n=this._logger.create("_revokeInternal"),t){e.next=4;break}return e.abrupt("return");case 4:if((i=r.filter((function(e){return"string"==typeof t[e]}))).length){e.next=8;break}return n.debug("no need to revoke due to no token(s)"),e.abrupt("return");case 8:o=D(i),e.prev=9,o.s();case 11:if((s=o.n()).done){e.next=19;break}return a=s.value,e.next=15,this._client.revokeToken(t[a],a);case 15:n.info("".concat(a," revoked successfully")),"access_token"!==a&&(t[a]=null);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),o.e(e.t0);case 24:return e.prev=24,o.f(),e.finish(24);case 27:return e.next=29,this.storeUser(t);case 29:return n.debug("user stored"),e.next=32,this._events.load(t);case 32:case"end":return e.stop()}}),e,this,[[9,21,24,27]])}))),function(e){return n.apply(this,arguments)})},{key:"startSilentRenew",value:function(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}},{key:"stopSilentRenew",value:function(){this._silentRenewService.stop()}},{key:"_userStoreKey",get:function(){return"user:".concat(this.settings.authority,":").concat(this.settings.client_id)}},{key:"_loadUser",value:(r=N(R().mark((function e(){var t,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("_loadUser"),e.next=3,this.settings.userStore.get(this._userStoreKey);case 3:if(!(r=e.sent)){e.next=7;break}return t.debug("user storageString loaded"),e.abrupt("return",Ne.fromStorageString(r));case 7:return t.debug("no user storageString"),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"storeUser",value:(t=N(R().mark((function e(t){var r,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._logger.create("storeUser"),!t){e.next=8;break}return r.debug("storing user"),n=t.toStorageString(),e.next=6,this.settings.userStore.set(this._userStoreKey,n);case 6:e.next=11;break;case 8:return this._logger.debug("removing user"),e.next=11,this.settings.userStore.remove(this._userStoreKey);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clearStaleState",value:(e=N(R().mark((function e(){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.clearStaleState();case 2:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e,t,r,n,i,o,s,a,g,v,_,b,w,k,S,x,E,I,O,T,C,P,A,L,M,q,F,$,B,H,W}(),ze="3.0.1"},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":r(window))&&(n=window)}e.exports=n},function(e,t,r){var n=r(1),i=r(2).useAuth,o=function(e){var t=e.children,r=e.onClick,n=i();return React.createElement("div",{style:{border:"none",width:"100%",height:"100%"},onClick:function(){n.signoutRedirect(),r()}},t)},s=n.defineReactNode({name:"Logout action",category:"Tutorial",getReactComponent:function(){return o},inputProps:{},outputProps:{onClick:{type:"signal",displayName:"Click"}}});e.exports={LogoutNode:s}},function(e,t,r){var n=r(1),i=r(0).useEffect,o=r(2).useAuth;function s(e){var t=e.children,r=e.currentUser,n=void 0===r?function(){}:r,s=o();return i((function(){var e;n(null!=s&&s.isAuthenticated?null==s||null===(e=s.user)||void 0===e||null===(e=e.profile)||void 0===e?void 0:e.sub:"")}),[s]),t}var a=n.defineReactNode({name:"Set Current User",category:"Tutorial",getReactComponent:function(){return s},inputProps:{},outputProps:{currentUser:{type:"data",displayName:"Current User"}}});e.exports={SetCurrentUserNode:a}},function(e,t,r){var n=r(1),i=r(0).useEffect,o=r(2).useAuth;function s(e){var t=e.children,r=e.accessToken,n=void 0===r?function(){}:r,s=o();return i((function(){var e;n(null!=s&&s.isAuthenticated?null===(e=s.user)||void 0===e?void 0:e.access_token:"")}),[s]),t}var a=n.defineReactNode({name:"Set Access Token",category:"Tutorial",getReactComponent:function(){return s},inputProps:{},outputProps:{accessToken:{type:"data",displayName:"Access token"}}});e.exports={SetAccessTokenNode:a}},function(e,t,r){var n=r(1),i=r(2).useAuth,o=function(e){var t=e.children,r=(e.onClick,i());return React.createElement("div",{style:{border:"none",width:"100%",height:"100%"},onClick:function(){r.signinRedirect()}},t)},s=n.defineReactNode({name:"Login action",category:"Tutorial",getReactComponent:function(){return o},inputProps:{},outputProps:{}});e.exports={LoginNode:s}},function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var s=r(1),a=r(0),u=a.useEffect,c=a.useState,l=r(2).useAuth,p=r(4),f=r(3).jwtDecode;function h(e){var t=e.children,r=e.role_claim_json_path,o=void 0===r?"roles":r,s=e.required_roles,a=void 0===s?"":s,h=e.hasResourceAccess,d=void 0===h?function(){}:h,g=l(),y=n(c(null),2),v=y[0],m=y[1],_=n(c(!1),2),b=_[0],w=_[1],k=n(c([]),2),S=k[0],x=k[1];return u((function(){var e;if(null!=g&&g.isAuthenticated&&null!==(e=g.user)&&void 0!==e&&e.access_token){var t=g.user.access_token;m(f(t)),x(a.split(",").filter((function(e){return e})))}}),[g]),u((function(){d(b)}),[b]),u((function(){if(v&&(null==S?void 0:S.length)>0)try{var e,t=(null===(e=p.query(v,o))||void 0===e?void 0:e[0])||[];if(null==t||!t.length)return;var r,n=t.reduce((function(e,t){return e[t]=!0,e}),{}),s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}(S);try{for(s.s();!(r=s.n()).done;){if(n[r.value])return void w(!0)}}catch(e){s.e(e)}finally{s.f()}return}catch(e){return void console.log(e)}else if(v&&(null==S||!S.length))return void w(!0)}),[S,v]),t}var d=s.defineReactNode({name:"AuthenticatedGuard",category:"Tutorial",getReactComponent:function(){return h},inputProps:{role_claim_json_path:{type:"string",default:"resource_access.test.roles",displayName:"Role Claim JSON Path"},required_roles:{type:"string",default:"admin",displayName:"Required roles (comma separated string)"}},outputProps:{hasResourceAccess:{type:"data",displayName:"Has Resource access"}}});e.exports={AuthenticatedGuardNode:d}}]);
//# sourceMappingURL=index.js.map